<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å…³äºçº¿ç¨‹æ± çš„ä¸€äº›è®¾è®¡ä»¥åŠé—®é¢˜æ’æŸ¥</title>
      <link href="/2023/04/19/thread-pool3/"/>
      <url>/2023/04/19/thread-pool3/</url>
      
        <content type="html"><![CDATA[<h3 id="å…³äºçº¿ç¨‹æ± çš„ä¸€äº›è®¾è®¡ä»¥åŠé—®é¢˜æ’æŸ¥"><a class="markdownIt-Anchor" href="#å…³äºçº¿ç¨‹æ± çš„ä¸€äº›è®¾è®¡ä»¥åŠé—®é¢˜æ’æŸ¥">#</a> å…³äºçº¿ç¨‹æ± çš„ä¸€äº›è®¾è®¡ä»¥åŠé—®é¢˜æ’æŸ¥</h3><p>å…³äºä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸ºäº†å®ç°èµ„æºçš„é«˜æ•ˆç®¡ç†ï¼Œé€‰ç”¨ shared_ptr æ™ºèƒ½æŒ‡é’ˆ</p><p>ä½¿ç”¨ bind å‡½æ•°å®ç°ç±»å¤–å®šä¹‰çš„ç±»èƒ½å¤Ÿè®¿é—®æœ¬ç±»æ‰€æ‹¥æœ‰çš„ç§æœ‰å‡½æ•°ä»¥åŠç§æœ‰å˜é‡</p><h4 id="åœ¨éªŒè¯çº¿ç¨‹æ± çš„æ—¶å€™å‘ç°æ‰“å°å‡ºæ¥çš„çº¿ç¨‹idéƒ½ä¸€æ ·äºæ˜¯æ’æŸ¥å“ªé‡Œå‡ºäº†é—®é¢˜"><a class="markdownIt-Anchor" href="#åœ¨éªŒè¯çº¿ç¨‹æ± çš„æ—¶å€™å‘ç°æ‰“å°å‡ºæ¥çš„çº¿ç¨‹idéƒ½ä¸€æ ·äºæ˜¯æ’æŸ¥å“ªé‡Œå‡ºäº†é—®é¢˜">#</a> åœ¨éªŒè¯çº¿ç¨‹æ± çš„æ—¶å€™å‘ç°æ‰“å°å‡ºæ¥çš„çº¿ç¨‹ ID éƒ½ä¸€æ ·ï¼Œäºæ˜¯æ’æŸ¥å“ªé‡Œå‡ºäº†é—®é¢˜</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">begin threadFunc tid 140654060929984</span><br><span class="line">end threadFunc tid 140654060929984</span><br><span class="line">begin threadFunc tid 140654060929984</span><br><span class="line">end threadFunc tid 140654060929984</span><br><span class="line">begin threadFunc tid 140654060929984</span><br><span class="line">end threadFunc tid 140654060929984</span><br><span class="line">begin threadFunc tid 140654060929984</span><br><span class="line">end threadFunc tid 140654060929984</span><br></pre></td></tr></table></figure><p>æ‰€å†™çº¿ç¨‹æ± åˆ›å»º ID</p><p>åŸä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ThreadPool::start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºçº¿ç¨‹å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span> ; i &lt; initThreadSize_; i ++) &#123;</span><br><span class="line">        threads_.<span class="built_in">emplace_back</span>(<span class="keyword">new</span> <span class="built_in">Thread</span>(std::<span class="built_in">bind</span>(&amp;ThreadPool::threadFunc,<span class="keyword">this</span>)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¯åŠ¨æ‰€æœ‰çº¿ç¨‹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span> ; i &lt; initThreadSize_; i ++) &#123;</span><br><span class="line">        threads_[i]-&gt;<span class="built_in">start</span>();<span class="comment">//æ‰§è¡Œçº¿ç¨‹å‡½æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Thread::start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::thread <span class="title">t</span><span class="params">(func_)</span></span>; </span><br><span class="line">    t.<span class="built_in">detach</span>();<span class="comment">//è®¾ç½®åˆ†ç¦»çº¿ç¨‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Thread::<span class="built_in">Thread</span>(ThreadFunc func)&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;begin threadFunc tid &quot;</span>&lt;&lt; std::this_thread::<span class="built_in">get_id</span>() &lt;&lt;std::endl;</span><br><span class="line">    std::cout&lt;&lt; <span class="string">&quot;end threadFunc tid &quot;</span>&lt;&lt;std::this_thread::<span class="built_in">get_id</span>() &lt;&lt;std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»”ç»†æ’æŸ¥å‘ç°åº”è¯¥æ˜¯è¿™æ ·</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ThreadPool::threadFunc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;begin threadFunc tid &quot;</span>&lt;&lt; std::this_thread::<span class="built_in">get_id</span>() &lt;&lt;std::endl;</span><br><span class="line">    std::cout&lt;&lt; <span class="string">&quot;end threadFunc tid &quot;</span>&lt;&lt;std::this_thread::<span class="built_in">get_id</span>() &lt;&lt;std::endl&lt;&lt;std::endl;</span><br><span class="line">    <span class="built_in">sleep</span>(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Thread::start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::thread <span class="title">t</span><span class="params">(func_)</span></span>; </span><br><span class="line">    t.<span class="built_in">detach</span>();<span class="comment">//è®¾ç½®åˆ†ç¦»çº¿ç¨‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Thread::<span class="built_in">Thread</span>(ThreadFunc func)</span><br><span class="line">    :<span class="built_in">func_</span>(func)</span><br><span class="line">&#123;&#125;</span><br><span class="line">Thread:: ~<span class="built_in">Thread</span>()&#123;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è§£å†³</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">begin threadFunc tid 140554644977216</span><br><span class="line">end threadFunc tid 140554644977216</span><br><span class="line"></span><br><span class="line">begin threadFunc tid 140554653369920</span><br><span class="line">begin threadFunc tid 140554653369920</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ˜æ˜çº¿ç¨‹æ± é‡Œæœ‰å››ä¸ªçº¿ç¨‹ï¼Œä¸ºä»€ä¹ˆåªè¿è¡Œäº†ä¸¤ä¸ªå‘¢ï¼Ÿ</p><p>æŸ¥é˜…èµ„æ–™å‘ç°ï¼Œæ˜¯ä¸»çº¿ç¨‹è¿è¡Œæ—¶é—´å¤ªå¿«äº†ï¼Œå› æ­¤è®©ä¸»çº¿ç¨‹ç¡ä¸€ä¼šå„¿ï½</p><p>ä¸»çº¿ç¨‹åŠ ä¸Š sleep (3) åå‘ç°æœç„¶ï¼ŒæˆåŠŸï¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">begin threadFunc tid <span class="number">140566920504896</span></span><br><span class="line">end threadFunc tid <span class="number">140566920504896</span></span><br><span class="line"></span><br><span class="line">begin threadFunc tid <span class="number">140566928897600</span></span><br><span class="line">end threadFunc tid <span class="number">140566928897600</span></span><br><span class="line"></span><br><span class="line">begin threadFunc tid <span class="number">140566937290304</span></span><br><span class="line">end threadFunc tid <span class="number">140566937290304</span></span><br><span class="line"></span><br><span class="line">begin threadFunc tid <span class="number">140566945683008</span></span><br><span class="line">end threadFunc tid <span class="number">140566945683008</span></span><br></pre></td></tr></table></figure><h4 id="å‘ç°çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ç”¨çš„æ˜¯è£¸æŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#å‘ç°çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ç”¨çš„æ˜¯è£¸æŒ‡é’ˆ">#</a> å‘ç°çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ç”¨çš„æ˜¯è£¸æŒ‡é’ˆ</h4><p>ä¿®æ”¹ä¸º unique_ptr åç„¶åå‘ç°ä»¥ä¸‹é—®é¢˜</p><p ::new((void="" *)__p)="" _Up(std::forward&lt;_Args(__args)...);="">/usr/include/c++/11/ext/new_allocator.h:162:11: error: cannot convert â€˜std::unique_ptr&lt;Thread, std::default_delete<Thread> &gt;â€™ to â€˜Thread*â€™ in initialization<br>162 |        </p><p>å·¦å€¼å¼•ç”¨é—®é¢˜</p><p>move ä¸€ä¸‹</p><p>ç„¶åè¿˜æ˜¯é”™è¯¯</p><p>é™·å…¥æ²‰æ€</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> ptr = std::<span class="built_in">make_unique</span>&lt;Thread&gt;(std::<span class="built_in">bind</span>(&amp;ThreadPool::threadFunc,<span class="keyword">this</span>));</span><br><span class="line">threads_.<span class="built_in">emplace_back</span>(std::<span class="built_in">move</span>(ptr));</span><br></pre></td></tr></table></figure><p>é€†å¤©ï¼</p><p>æ°”æ­»æˆ‘äº†ï¼</p><p>å› ä¸ºæ˜¯è¿œç¨‹è¿æ¥ ECS çš„åŸå› ï¼Œå¤´æ–‡ä»¶æ²¡ä¿å­˜ï¼Œ</p><p>å¿ƒä¸­ä¸€ä¸‡åªè‰æ³¥ğŸå¥”è…¾ï¼</p><p>æ‰€ä»¥ä¿®æ”¹æˆåŠŸï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> bug </tag>
            
            <tag> çº¿ç¨‹æ± å®ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘çŠ¶æ•°ç»„</title>
      <link href="/2023/04/19/acw1/"/>
      <url>/2023/04/19/acw1/</url>
      
        <content type="html"><![CDATA[<ol start="241"><li>æ¥¼å…°å›¾è…¾</li></ol><p>åœ¨å®Œæˆäº†åˆ†é…ä»»åŠ¡ä¹‹åï¼Œè¥¿éƒ¨ 314314 æ¥åˆ°äº†æ¥¼å…°å¤åŸçš„è¥¿éƒ¨ã€‚</p><p>ç›¸ä¼ å¾ˆä¹…ä»¥å‰è¿™ç‰‡åœŸåœ°ä¸Š (æ¯”æ¥¼å…°å¤åŸè¿˜æ—©) ç”Ÿæ´»ç€ä¸¤ä¸ªéƒ¨è½ï¼Œä¸€ä¸ªéƒ¨è½å´‡æ‹œå°–åˆ€ ( <code>V</code> )ï¼Œä¸€ä¸ªéƒ¨è½å´‡æ‹œé“é”¹ ( <code>âˆ§</code> )ï¼Œä»–ä»¬åˆ†åˆ«ç”¨  <code>V</code>  å’Œ  <code>âˆ§</code>  çš„å½¢çŠ¶æ¥ä»£è¡¨å„è‡ªéƒ¨è½çš„å›¾è…¾ã€‚</p><p>è¥¿éƒ¨ 314314 åœ¨æ¥¼å…°å¤åŸçš„ä¸‹é¢å‘ç°äº†ä¸€å¹…å·¨å¤§çš„å£ç”»ï¼Œå£ç”»ä¸Šè¢«æ ‡è®°å‡ºäº† n  ä¸ªç‚¹ï¼Œç»æµ‹é‡å‘ç°è¿™ n ä¸ªç‚¹çš„æ°´å¹³ä½ç½®å’Œç«–ç›´ä½ç½®æ˜¯ä¸¤ä¸¤ä¸åŒçš„ã€‚</p><p>è¥¿éƒ¨ 314314 è®¤ä¸ºè¿™å¹…å£ç”»æ‰€åŒ…å«çš„ä¿¡æ¯ä¸è¿™ n  ä¸ªç‚¹çš„ç›¸å¯¹ä½ç½®æœ‰å…³ï¼Œå› æ­¤ä¸å¦¨è®¾åæ ‡åˆ†åˆ«ä¸º (1,y1),(2,y2),â€¦,(n,yn)(1, 1),(2, 2),â€¦,( ,  )ï¼Œå…¶ä¸­ y1âˆ¼yn 1âˆ¼   æ˜¯ 11 åˆ° n  çš„ä¸€ä¸ªæ’åˆ—ã€‚</p><p>è¥¿éƒ¨ 314314 æ‰“ç®—ç ”ç©¶è¿™å¹…å£ç”»ä¸­åŒ…å«ç€å¤šå°‘ä¸ªå›¾è…¾ã€‚</p><p>å¦‚æœä¸‰ä¸ªç‚¹ (i,yi),(j,yj),(k,yk)( ,  ),( ,  ),( ,  ) æ»¡è¶³ 1â‰¤i&lt;j&lt;kâ‰¤n1â‰¤ &lt; &lt; â‰¤  ä¸” yi&gt;yj,yj<yk  >  ,  &lt;  ï¼Œåˆ™ç§°è¿™ä¸‰ä¸ªç‚¹æ„æˆ  <code>V</code>  å›¾è…¾ï¼›</p><p>å¦‚æœä¸‰ä¸ªç‚¹ (i,yi),(j,yj),(k,yk)( ,  ),( ,  ),( ,  ) æ»¡è¶³ 1â‰¤i&lt;j&lt;kâ‰¤n1â‰¤ &lt; &lt; â‰¤  ä¸” yi&lt;yj,yj&gt;yk  &lt;  ,  &gt;  ï¼Œåˆ™ç§°è¿™ä¸‰ä¸ªç‚¹æ„æˆ  <code>âˆ§</code>  å›¾è…¾ï¼›</p><p>è¥¿éƒ¨ 314314 æƒ³çŸ¥é“ï¼Œè¿™ n  ä¸ªç‚¹ä¸­ä¸¤ä¸ªéƒ¨è½å›¾è…¾çš„æ•°ç›®ã€‚</p><p>å› æ­¤ï¼Œä½ éœ€è¦ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥æ±‚å‡º  <code>V</code>  çš„ä¸ªæ•°å’Œ  <code>âˆ§</code>  çš„ä¸ªæ•°ã€‚</p><h4 id="è¾“å…¥æ ¼å¼"><a class="markdownIt-Anchor" href="#è¾“å…¥æ ¼å¼">#</a> è¾“å…¥æ ¼å¼</h4><p>ç¬¬ä¸€è¡Œä¸€ä¸ªæ•° n ã€‚</p><p>ç¬¬äºŒè¡Œæ˜¯ n  ä¸ªæ•°ï¼Œåˆ†åˆ«ä»£è¡¨ y1ï¼Œy2,â€¦,yn 1ï¼Œ 2,â€¦,  ã€‚</p><h4 id="è¾“å‡ºæ ¼å¼"><a class="markdownIt-Anchor" href="#è¾“å‡ºæ ¼å¼">#</a> è¾“å‡ºæ ¼å¼</h4><p>ä¸¤ä¸ªæ•°ï¼Œä¸­é—´ç”¨ç©ºæ ¼éš”å¼€ï¼Œä¾æ¬¡ä¸º  <code>V</code>  çš„ä¸ªæ•°å’Œ  <code>âˆ§</code>  çš„ä¸ªæ•°ã€‚</p><h4 id="æ•°æ®èŒƒå›´"><a class="markdownIt-Anchor" href="#æ•°æ®èŒƒå›´">#</a> æ•°æ®èŒƒå›´</h4><p>å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œnâ‰¤200000 â‰¤200000ï¼Œä¸”è¾“å‡ºç­”æ¡ˆä¸ä¼šè¶…è¿‡ int64   64ã€‚<br>y1âˆ¼yn 1âˆ¼   æ˜¯ 11 åˆ° n  çš„ä¸€ä¸ªæ’åˆ—ã€‚</p><h4 id="è¾“å…¥æ ·ä¾‹"><a class="markdownIt-Anchor" href="#è¾“å…¥æ ·ä¾‹">#</a> è¾“å…¥æ ·ä¾‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">1 5 3 2 4</span><br></pre></td></tr></table></figure><h4 id="è¾“å‡ºæ ·ä¾‹"><a class="markdownIt-Anchor" href="#è¾“å‡ºæ ·ä¾‹">#</a> è¾“å‡ºæ ·ä¾‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3 4</span><br></pre></td></tr></table></figure><p>æ­¤é¢˜ç”¨æ ‘çŠ¶æ•°ç»„ï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹æ‰¾å‡ºå…¶å·¦è¾¹æ¯”è¯¥ç‚¹å€¼å¤§çš„ï¼Œå³è¾¹äº¦å¦‚æ­¤ï¼Œä¸¤ä¸ªæ•°ç›¸ä¹˜ï¼Œæœ€åå¾—åˆ°çš„æ•°å°±æ˜¯è¯¥ç‚¹ä¸­ V çš„å›¾è…¾ä¸ªæ•°ï¼Œn æ­£å¥½ç›¸åã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">200010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> tr[N];</span><br><span class="line"><span class="type">int</span> Greater[N], lower[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = x; i &lt;= n; i += <span class="built_in">lowbit</span>(i)) tr[i] += c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = x; i; i -= <span class="built_in">lowbit</span>(i)) res += tr[i];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ ) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ ) &#123;</span><br><span class="line">        <span class="type">int</span> y = a[i];</span><br><span class="line">        Greater[i] = <span class="built_in">sum</span>(n) - <span class="built_in">sum</span>(y);</span><br><span class="line">        lower[i] = <span class="built_in">sum</span>(y - <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">add</span>(y, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(tr, <span class="number">0</span>, <span class="keyword">sizeof</span> tr);</span><br><span class="line">    LL res1 = <span class="number">0</span>, res2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i; i -- ) &#123;</span><br><span class="line">        <span class="type">int</span> y = a[i];</span><br><span class="line">        res1 += Greater[i] * (LL)(<span class="built_in">sum</span>(n) - <span class="built_in">sum</span>(y));</span><br><span class="line">        res2 += lower[i] * (LL)(<span class="built_in">sum</span>(y - <span class="number">1</span>));</span><br><span class="line">        <span class="built_in">add</span>(y, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>, res1, res2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ ‘çŠ¶æ•°ç»„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜day7</title>
      <link href="/2023/04/19/day7/"/>
      <url>/2023/04/19/day7/</url>
      
        <content type="html"><![CDATA[<h4 id="15-ä¸‰æ•°ä¹‹å’Œ"><a class="markdownIt-Anchor" href="#15-ä¸‰æ•°ä¹‹å’Œ">#</a> <a href="https://leetcode.cn/problems/3sum/">15. ä¸‰æ•°ä¹‹å’Œ</a></h4><p>éš¾åº¦ä¸­ç­‰ 5885 æ”¶è—åˆ†äº«åˆ‡æ¢ä¸ºè‹±æ–‡æ¥æ”¶åŠ¨æ€åé¦ˆ</p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„  <code>nums</code>  ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸‰å…ƒç»„  <code>[nums[i], nums[j], nums[k]]</code>  æ»¡è¶³  <code>i != j</code> ã€ <code>i != k</code>  ä¸”  <code>j != k</code>  ï¼ŒåŒæ—¶è¿˜æ»¡è¶³  <code>nums[i] + nums[j] + nums[k] == 0</code>  ã€‚è¯·</p><p>ä½ è¿”å›æ‰€æœ‰å’Œä¸º  <code>0</code>  ä¸”ä¸é‡å¤çš„ä¸‰å…ƒç»„ã€‚</p><p>** æ³¨æ„ï¼š** ç­”æ¡ˆä¸­ä¸å¯ä»¥åŒ…å«é‡å¤çš„ä¸‰å…ƒç»„ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [-1,0,1,2,-1,-4]</span><br><span class="line">è¾“å‡ºï¼š[[-1,-1,2],[-1,0,1]]</span><br><span class="line">è§£é‡Šï¼š</span><br><span class="line">nums[0] + nums[1] + nums[2] = (-1) + 0 + 1 = 0 ã€‚</span><br><span class="line">nums[1] + nums[2] + nums[4] = 0 + 1 + (-1) = 0 ã€‚</span><br><span class="line">nums[0] + nums[3] + nums[4] = (-1) + 2 + (-1) = 0 ã€‚</span><br><span class="line">ä¸åŒçš„ä¸‰å…ƒç»„æ˜¯ [-1,0,1] å’Œ [-1,-1,2] ã€‚</span><br><span class="line">æ³¨æ„ï¼Œè¾“å‡ºçš„é¡ºåºå’Œä¸‰å…ƒç»„çš„é¡ºåºå¹¶ä¸é‡è¦ã€‚</span><br></pre></td></tr></table></figure><p>ä¸‰æ ‘ä¹‹å’Œï¼Œç»å…¸è€é¢˜äº†ã€‚</p><p>å…ˆå°†æ•°ç»„æ’åºï¼Œéšåç”¨åŒæŒ‡é’ˆï¼Œä»å¤´åˆ°å°¾ï¼Œslow çš„è¯ä» i+1 å¼€å§‹ï¼Œfast ä»æœ«å°¾å¼€å§‹ã€‚</p><p>å¦‚æœ nums [i] + nums [slow] + nums [fast] &lt; 0</p><p>å°† slow å³ç§»</p><p>å¦‚æœä¸Šé¢é‚£ä¸ªå€¼å¤§äº 0</p><p>å°† fast å·¦ç§»</p><p>æ¯æ¬¡ç§»åŠ¨é¿å¼€ç›¸åŒçš„å€¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">threeSum</span>(vector&lt;<span class="type">int</span>&gt;&amp; nums) &#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; res;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>()<span class="number">-2</span>; i ++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[i] &gt; <span class="number">0</span> ) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(i &gt; <span class="number">0</span> &amp;&amp; nums[i] == nums[i<span class="number">-1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> slow = i + <span class="number">1</span>, fast = nums.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">while</span> (slow &lt; fast) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((nums[slow]+nums[fast]+nums[i]) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    slow ++;</span><br><span class="line">                    <span class="comment">//while (nums[slow] == nums[slow-1] &amp;&amp; slow &lt; fast) slow ++;</span></span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> ((nums[slow]+nums[fast]+nums[i]) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    fast --;</span><br><span class="line">                    <span class="comment">//while (nums[fast] == nums[fast+1] &amp;&amp; slow &lt; fast) fast --;</span></span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    res.<span class="built_in">push_back</span>(&#123;nums[i], nums[slow], nums[fast]&#125;);</span><br><span class="line">                    slow ++;</span><br><span class="line">                    <span class="keyword">while</span> (nums[slow] == nums[slow<span class="number">-1</span>] &amp;&amp; slow &lt; fast) slow ++;</span><br><span class="line">                    fast --;</span><br><span class="line">                    <span class="keyword">while</span> (nums[fast] == nums[fast+<span class="number">1</span>] &amp;&amp; slow &lt; fast) fast --;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//res.erase(unique(res.begin(), res.end()), res.end());</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="206-åè½¬é“¾è¡¨"><a class="markdownIt-Anchor" href="#206-åè½¬é“¾è¡¨">#</a> <a href="https://leetcode.cn/problems/reverse-linked-list/">206. åè½¬é“¾è¡¨</a></h4><p>éš¾åº¦ç®€å• 3105 æ”¶è—åˆ†äº«åˆ‡æ¢ä¸ºè‹±æ–‡æ¥æ”¶åŠ¨æ€åé¦ˆ</p><p>ç»™ä½ å•é“¾è¡¨çš„å¤´èŠ‚ç‚¹  <code>head</code>  ï¼Œè¯·ä½ åè½¬é“¾è¡¨ï¼Œå¹¶è¿”å›åè½¬åçš„é“¾è¡¨ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2021/02/19/rev1ex1.jpg" class="lazyload placeholder" data-srcset="https://assets.leetcode.com/uploads/2021/02/19/rev1ex1.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1,2,3,4,5]</span><br><span class="line">è¾“å‡ºï¼š[5,4,3,2,1]</span><br></pre></td></tr></table></figure><p>æ­¤é¢˜ easy é¢˜ï¼Œç”¨ä¸€ä¸ªå¤´èŠ‚ç‚¹å³å¯è½»æ¾å®Œæˆç¿»è½¬</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        ListNode* q = <span class="literal">nullptr</span>;</span><br><span class="line">        ListNode* h = head;</span><br><span class="line">        <span class="keyword">while</span> (h) &#123;</span><br><span class="line">            ListNode* ne = h-&gt;next;</span><br><span class="line">            h-&gt;next = q;</span><br><span class="line">            q = h;</span><br><span class="line">            h = ne;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> q;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="538-æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘"><a class="markdownIt-Anchor" href="#538-æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘">#</a> <a href="https://leetcode.cn/problems/convert-bst-to-greater-tree/">538. æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘</a></h4><p>éš¾åº¦ä¸­ç­‰ 880 æ”¶è—åˆ†äº«åˆ‡æ¢ä¸ºè‹±æ–‡æ¥æ”¶åŠ¨æ€åé¦ˆ</p><p>ç»™å‡ºäºŒå‰ <strong>æœç´¢</strong> æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¯¥æ ‘çš„èŠ‚ç‚¹å€¼å„ä¸ç›¸åŒï¼Œè¯·ä½ å°†å…¶è½¬æ¢ä¸ºç´¯åŠ æ ‘ï¼ˆGreater Sum Treeï¼‰ï¼Œä½¿æ¯ä¸ªèŠ‚ç‚¹  <code>node</code>  çš„æ–°å€¼ç­‰äºåŸæ ‘ä¸­å¤§äºæˆ–ç­‰äº  <code>node.val</code>  çš„å€¼ä¹‹å’Œã€‚</p><p>æé†’ä¸€ä¸‹ï¼ŒäºŒå‰æœç´¢æ ‘æ»¡è¶³ä¸‹åˆ—çº¦æŸæ¡ä»¶ï¼š</p><ul><li>èŠ‚ç‚¹çš„å·¦å­æ ‘ä»…åŒ…å«é”® <strong>å°äº</strong> èŠ‚ç‚¹é”®çš„èŠ‚ç‚¹ã€‚</li><li>èŠ‚ç‚¹çš„å³å­æ ‘ä»…åŒ…å«é”® <strong>å¤§äº</strong> èŠ‚ç‚¹é”®çš„èŠ‚ç‚¹ã€‚</li><li>å·¦å³å­æ ‘ä¹Ÿå¿…é¡»æ˜¯äºŒå‰æœç´¢æ ‘ã€‚</li></ul><p>** æ³¨æ„ï¼š** æœ¬é¢˜å’Œ 1038: <a href="https://leetcode-cn.com/problems/binary-search-tree-to-greater-sum-tree/">https://leetcode-cn.com/problems/binary-search-tree-to-greater-sum-tree/</a> ç›¸åŒ</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><strong><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2019/05/03/tree.png" class="lazyload placeholder" data-srcset="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2019/05/03/tree.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="img"></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼š[4,1,6,0,2,5,7,null,null,null,3,null,null,null,8]</span><br><span class="line">è¾“å‡ºï¼š[30,36,21,36,35,26,15,null,null,null,33,null,null,null,8]</span><br></pre></td></tr></table></figure><p>åå‘ä¸­åºéå†</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">TreeNode* <span class="title">convertBST</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="built_in">convertBST</span>(root-&gt;right);</span><br><span class="line">            sum += root-&gt;val;</span><br><span class="line">            root-&gt;val = sum;</span><br><span class="line">            <span class="built_in">convertBST</span>(root-&gt;left);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ol start="241"><li></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> lc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜day6</title>
      <link href="/2023/04/18/day6/"/>
      <url>/2023/04/18/day6/</url>
      
        <content type="html"><![CDATA[<h4 id="75-é¢œè‰²åˆ†ç±»"><a class="markdownIt-Anchor" href="#75-é¢œè‰²åˆ†ç±»">#</a> <a href="https://leetcode.cn/problems/sort-colors/">75. é¢œè‰²åˆ†ç±»</a></h4><p>ç»™å®šä¸€ä¸ªåŒ…å«çº¢è‰²ã€ç™½è‰²å’Œè“è‰²ã€å…± n ä¸ªå…ƒç´ çš„æ•°ç»„ nums ï¼ŒåŸåœ°å¯¹å®ƒä»¬è¿›è¡Œæ’åºï¼Œä½¿å¾—ç›¸åŒé¢œè‰²çš„å…ƒç´ ç›¸é‚»ï¼Œå¹¶æŒ‰ç…§çº¢è‰²ã€ç™½è‰²ã€è“è‰²é¡ºåºæ’åˆ—ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨æ•´æ•° 0ã€ 1 å’Œ 2 åˆ†åˆ«è¡¨ç¤ºçº¢è‰²ã€ç™½è‰²å’Œè“è‰²ã€‚</p><p>å¿…é¡»åœ¨ä¸ä½¿ç”¨åº“å†…ç½®çš„ sort å‡½æ•°çš„æƒ…å†µä¸‹è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>ç¤ºä¾‹</mtext><mn>1</mn><mtext>ï¼šè¾“å…¥ï¼š</mtext><mi>n</mi><mi>u</mi><mi>m</mi><mi>s</mi><mo>=</mo><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo><mtext>è¾“å‡ºï¼š</mtext><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">ç¤ºä¾‹ 1ï¼šè¾“å…¥ï¼šnums = [2,0,2,1,1,0]è¾“å‡ºï¼š[0,0,1,1,2,2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ç¤º</span><span class="mord cjk_fallback">ä¾‹</span><span class="mord">1</span><span class="mord cjk_fallback">ï¼š</span><span class="mord cjk_fallback">è¾“</span><span class="mord cjk_fallback">å…¥</span><span class="mord cjk_fallback">ï¼š</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">]</span><span class="mord cjk_fallback">è¾“</span><span class="mord cjk_fallback">å‡º</span><span class="mord cjk_fallback">ï¼š</span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">]</span></span></span></span></span></p><p>è¿™ä¸ªé¢˜ï¼Œç‚’é¸¡ç®€å•ã€‚ã€</p><p>å…ˆæŠŠ 0 æ”¾æ”¾å‰é¢ï¼Œå†æŠŠ 1 æ”¾å‰é¢ï¼Œå°±è¡Œäº†</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">sortColors</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> zero = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> two = nums.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i ++) &#123;</span><br><span class="line">             <span class="keyword">if</span> (nums[i] == <span class="number">0</span>) <span class="built_in">swap</span>(nums[i], nums[zero++]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i ++) &#123;</span><br><span class="line">             <span class="keyword">if</span> (nums[i] == <span class="number">1</span>) <span class="built_in">swap</span>(nums[i], nums[zero++]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="55-è·³è·ƒæ¸¸æˆ"><a class="markdownIt-Anchor" href="#55-è·³è·ƒæ¸¸æˆ">#</a> <a href="https://leetcode.cn/problems/jump-game/">55. è·³è·ƒæ¸¸æˆ</a></h4><p>ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ nums ï¼Œä½ æœ€åˆä½äºæ•°ç»„çš„ ç¬¬ä¸€ä¸ªä¸‹æ ‡ ã€‚</p><p>æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä»£è¡¨ä½ åœ¨è¯¥ä½ç½®å¯ä»¥è·³è·ƒçš„æœ€å¤§é•¿åº¦ã€‚</p><p>åˆ¤æ–­ä½ æ˜¯å¦èƒ½å¤Ÿåˆ°è¾¾æœ€åä¸€ä¸ªä¸‹æ ‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [2,3,1,1,4]</span><br><span class="line">è¾“å‡ºï¼štrue</span><br><span class="line">è§£é‡Šï¼šå¯ä»¥å…ˆè·³ 1 æ­¥ï¼Œä»ä¸‹æ ‡ 0 åˆ°è¾¾ä¸‹æ ‡ 1, ç„¶åå†ä»ä¸‹æ ‡ 1 è·³ 3 æ­¥åˆ°è¾¾æœ€åä¸€ä¸ªä¸‹æ ‡ã€‚</span><br></pre></td></tr></table></figure><p>å¯¹æ¯ä¸ªç‚¹éƒ½æ±‚ä¸€ä¸‹æœ€å¤§å¯åˆ°è¾¾è·ç¦»ï¼Œå¦‚æœæœ‰ç‚¹çš„èƒ½å¤Ÿå¤§äºç­‰äº size-1ï¼Œå³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">canJump</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> r_max = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i ++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt;= r_max) &#123;</span><br><span class="line">                r_max = <span class="built_in">max</span>(r_max, nums[i] + i);</span><br><span class="line">                <span class="keyword">if</span> (r_max &gt;= n - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="å‰‘æŒ‡-offer-34-äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„"><a class="markdownIt-Anchor" href="#å‰‘æŒ‡-offer-34-äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„">#</a> <a href="https://leetcode.cn/problems/er-cha-shu-zhong-he-wei-mou-yi-zhi-de-lu-jing-lcof/">å‰‘æŒ‡ Offer 34. äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„</a></h4><p>ç»™ä½ äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å’Œ targetSum ï¼Œæ‰¾å‡ºæ‰€æœ‰ ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹ è·¯å¾„æ€»å’Œç­‰äºç»™å®šç›®æ ‡å’Œçš„è·¯å¾„ã€‚</p><p>å¶å­èŠ‚ç‚¹ æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://assets.leetcode.com/uploads/2021/01/18/pathsumii1.jpg" class="lazyload placeholder" data-srcset="https://assets.leetcode.com/uploads/2021/01/18/pathsumii1.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="img"></p><p>è¾“å…¥ï¼šroot = [5,4,8,11,null,13,4,7,2,null,null,5,1], targetSum = 22<br> è¾“å‡ºï¼š[[5,4,11,2],[5,8,4,5]]</p><p>è¿™é“é¢˜ï¼Œå¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œ dfs æ“ä½œï¼Œ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; res;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; r;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(TreeNode* root, <span class="type">int</span> target )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!root) <span class="keyword">return</span>;</span><br><span class="line">        r.<span class="built_in">push_back</span>(root-&gt;val);</span><br><span class="line">        target -= root-&gt;val;</span><br><span class="line">        <span class="keyword">if</span> (!root-&gt;left &amp;&amp; !root-&gt;right &amp;&amp; target == <span class="number">0</span>) &#123;</span><br><span class="line">            res.<span class="built_in">push_back</span>(r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dfs</span>(root-&gt;left, target);</span><br><span class="line">        <span class="built_in">dfs</span>(root-&gt;right, target);</span><br><span class="line">        r.<span class="built_in">pop_back</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">pathSum</span>(TreeNode* root, <span class="type">int</span> target) &#123;</span><br><span class="line">        <span class="built_in">dfs</span>(root, target);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ol start="1252"><li></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> lc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿ç¨‹æ± ä»£ç (æ•´åˆç‰ˆ)</title>
      <link href="/2023/04/18/thread-pool2/"/>
      <url>/2023/04/18/thread-pool2/</url>
      
        <content type="html"><![CDATA[<p>å…³äºçº¿ç¨‹æ± çš„è®¾è®¡ï¼Œå¾ˆå¤šéƒ½å’Œå†…å­˜æ± å·®ä¸å¤šï¼Œåœ¨æ­¤è´´ä¸Šæ€»ä½“ä»£ç ã€‚</p><p>åç»­å†æŒ¨ä¸ªåˆ†æç»†èŠ‚ä»¥åŠç¼–å†™è¿‡ç¨‹ä¸­çš„ Bug è°ƒè¯•</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> TASK_MAX_THRESHHOLD = <span class="number">2</span>; <span class="comment">// INT32_MAX;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> THREAD_MAX_THRESHHOLD = <span class="number">1024</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> THREAD_MAX_IDLE_TIME = <span class="number">60</span>; <span class="comment">// å•ä½ï¼šç§’</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹æ± æ”¯æŒçš„æ¨¡å¼</span></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">PoolMode</span> &#123;</span><br><span class="line">MODE_FIXED,  <span class="comment">// å›ºå®šæ•°é‡çš„çº¿ç¨‹</span></span><br><span class="line">MODE_CACHED, <span class="comment">// çº¿ç¨‹æ•°é‡å¯åŠ¨æ€å¢é•¿</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹ç±»å‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">// çº¿ç¨‹å‡½æ•°å¯¹è±¡ç±»å‹</span></span><br><span class="line"><span class="keyword">using</span> ThreadFunc = std::function&lt;<span class="built_in">void</span>(<span class="type">int</span>)&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹æ„é€ </span></span><br><span class="line"><span class="built_in">Thread</span>(ThreadFunc func)</span><br><span class="line">: <span class="built_in">func_</span>(func)</span><br><span class="line">, <span class="built_in">threadId_</span>(generateId_++)</span><br><span class="line">&#123;&#125;</span><br><span class="line"><span class="comment">// çº¿ç¨‹ææ„</span></span><br><span class="line">~<span class="built_in">Thread</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹å‡½æ•° pthread_create</span></span><br><span class="line"><span class="function">std::thread <span class="title">t</span><span class="params">(func_, threadId_)</span></span>;  <span class="comment">// C++11æ¥è¯´ çº¿ç¨‹å¯¹è±¡t  å’Œçº¿ç¨‹å‡½æ•°func_</span></span><br><span class="line">t.<span class="built_in">detach</span>(); <span class="comment">// è®¾ç½®åˆ†ç¦»çº¿ç¨‹   pthread_detach  pthread_tè®¾ç½®æˆåˆ†ç¦»çº¿ç¨‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–çº¿ç¨‹id</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getId</span><span class="params">()</span><span class="type">const</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> threadId_;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">ThreadFunc func_;</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> generateId_;</span><br><span class="line"><span class="type">int</span> threadId_;  <span class="comment">// ä¿å­˜çº¿ç¨‹id</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> Thread::generateId_ = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹æ± ç±»å‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadPool</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">// çº¿ç¨‹æ± æ„é€ </span></span><br><span class="line"><span class="built_in">ThreadPool</span>()</span><br><span class="line">: <span class="built_in">initThreadSize_</span>(<span class="number">0</span>)</span><br><span class="line">, <span class="built_in">taskSize_</span>(<span class="number">0</span>)</span><br><span class="line">, <span class="built_in">idleThreadSize_</span>(<span class="number">0</span>)</span><br><span class="line">, <span class="built_in">curThreadSize_</span>(<span class="number">0</span>)</span><br><span class="line">, <span class="built_in">taskQueMaxThreshHold_</span>(TASK_MAX_THRESHHOLD)</span><br><span class="line">, <span class="built_in">threadSizeThreshHold_</span>(THREAD_MAX_THRESHHOLD)</span><br><span class="line">, <span class="built_in">poolMode_</span>(PoolMode::MODE_FIXED)</span><br><span class="line">, <span class="built_in">isPoolRunning_</span>(<span class="literal">false</span>)</span><br><span class="line">&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹æ± ææ„</span></span><br><span class="line">~<span class="built_in">ThreadPool</span>() &#123;</span><br><span class="line">isPoolRunning_ = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰å¾…çº¿ç¨‹æ± é‡Œé¢æ‰€æœ‰çš„çº¿ç¨‹è¿”å›  æœ‰ä¸¤ç§çŠ¶æ€ï¼šé˜»å¡ &amp; æ­£åœ¨æ‰§è¡Œä»»åŠ¡ä¸­</span></span><br><span class="line"><span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(taskQueMtx_)</span></span>;</span><br><span class="line">notEmpty_.<span class="built_in">notify_all</span>();</span><br><span class="line">exitCond_.<span class="built_in">wait</span>(lock, [&amp;]()-&gt;<span class="type">bool</span> &#123;<span class="keyword">return</span> threads_.<span class="built_in">size</span>() == <span class="number">0</span>; &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®çº¿ç¨‹æ± çš„å·¥ä½œæ¨¡å¼</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setMode</span><span class="params">(PoolMode mode)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">checkRunningState</span>())</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">poolMode_ = mode;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®taskä»»åŠ¡é˜Ÿåˆ—ä¸Šçº¿é˜ˆå€¼</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setTaskQueMaxThreshHold</span><span class="params">(<span class="type">int</span> threshhold)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">checkRunningState</span>())</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">taskQueMaxThreshHold_ = threshhold;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®çº¿ç¨‹æ± cachedæ¨¡å¼ä¸‹çº¿ç¨‹é˜ˆå€¼</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setThreadSizeThreshHold</span><span class="params">(<span class="type">int</span> threshhold)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">checkRunningState</span>())</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span> (poolMode_ == PoolMode::MODE_CACHED)</span><br><span class="line">&#123;</span><br><span class="line">threadSizeThreshHold_ = threshhold;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™çº¿ç¨‹æ± æäº¤ä»»åŠ¡</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨å¯å˜å‚æ¨¡æ¿ç¼–ç¨‹ï¼Œè®©submitTaskå¯ä»¥æ¥æ”¶ä»»æ„ä»»åŠ¡å‡½æ•°å’Œä»»æ„æ•°é‡çš„å‚æ•°</span></span><br><span class="line"><span class="comment">// pool.submitTask(sum1, 10, 20);   csdn  å¤§ç§¦å‘ç‹  å³å€¼å¼•ç”¨+å¼•ç”¨æŠ˜å åŸç†</span></span><br><span class="line"><span class="comment">// è¿”å›å€¼future&lt;&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Func, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">submitTask</span><span class="params">(Func&amp;&amp; func, Args&amp;&amp;... args)</span> -&gt; std::future&lt;<span class="title">decltype</span><span class="params">(func(args...))</span>&gt; </span>&#123;</span><br><span class="line"><span class="comment">// æ‰“åŒ…ä»»åŠ¡ï¼Œæ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—é‡Œé¢</span></span><br><span class="line"><span class="keyword">using</span> RType = <span class="keyword">decltype</span>(<span class="built_in">func</span>(args...));</span><br><span class="line"><span class="keyword">auto</span> task = std::make_shared&lt;std::packaged_task&lt;<span class="built_in">RType</span>()&gt;&gt;(</span><br><span class="line">std::<span class="built_in">bind</span>(std::forward&lt;Func&gt;(func), std::forward&lt;Args&gt;(args)...));</span><br><span class="line">std::future&lt;RType&gt; result = task-&gt;<span class="built_in">get_future</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–é”</span></span><br><span class="line"><span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(taskQueMtx_)</span></span>;</span><br><span class="line"><span class="comment">// ç”¨æˆ·æäº¤ä»»åŠ¡ï¼Œæœ€é•¿ä¸èƒ½é˜»å¡è¶…è¿‡1sï¼Œå¦åˆ™åˆ¤æ–­æäº¤ä»»åŠ¡å¤±è´¥ï¼Œè¿”å›</span></span><br><span class="line"><span class="keyword">if</span> (!notFull_.<span class="built_in">wait_for</span>(lock, std::chrono::<span class="built_in">seconds</span>(<span class="number">1</span>),</span><br><span class="line">[&amp;]()-&gt;<span class="type">bool</span> &#123; <span class="keyword">return</span> taskQue_.<span class="built_in">size</span>() &lt; (<span class="type">size_t</span>)taskQueMaxThreshHold_; &#125;)) &#123;</span><br><span class="line"><span class="comment">// è¡¨ç¤ºnotFull_ç­‰å¾…1sç§ï¼Œæ¡ä»¶ä¾ç„¶æ²¡æœ‰æ»¡è¶³</span></span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;task queue is full, submit task fail.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">auto</span> task = std::make_shared&lt;std::packaged_task&lt;<span class="built_in">RType</span>()&gt;&gt;(</span><br><span class="line">[]()-&gt;RType &#123; <span class="keyword">return</span> <span class="built_in">RType</span>(); &#125;);</span><br><span class="line">(*task)();</span><br><span class="line"><span class="keyword">return</span> task-&gt;<span class="built_in">get_future</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæœ‰ç©ºä½™ï¼ŒæŠŠä»»åŠ¡æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­</span></span><br><span class="line"><span class="comment">// taskQue_.emplace(sp);  </span></span><br><span class="line"><span class="comment">// using Task = std::function&lt;void()&gt;;</span></span><br><span class="line">taskQue_.<span class="built_in">emplace</span>([task]() &#123;(*task)();&#125;);</span><br><span class="line">taskSize_++;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å› ä¸ºæ–°æ”¾äº†ä»»åŠ¡ï¼Œä»»åŠ¡é˜Ÿåˆ—è‚¯å®šä¸ç©ºäº†ï¼Œåœ¨notEmpty_ä¸Šè¿›è¡Œé€šçŸ¥ï¼Œèµ¶å¿«åˆ†é…çº¿ç¨‹æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">notEmpty_.<span class="built_in">notify_all</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// cachedæ¨¡å¼ ä»»åŠ¡å¤„ç†æ¯”è¾ƒç´§æ€¥ åœºæ™¯ï¼šå°è€Œå¿«çš„ä»»åŠ¡ éœ€è¦æ ¹æ®ä»»åŠ¡æ•°é‡å’Œç©ºé—²çº¿ç¨‹çš„æ•°é‡ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦åˆ›å»ºæ–°çš„çº¿ç¨‹å‡ºæ¥</span></span><br><span class="line"><span class="keyword">if</span> (poolMode_ == PoolMode::MODE_CACHED</span><br><span class="line">&amp;&amp; taskSize_ &gt; idleThreadSize_</span><br><span class="line">&amp;&amp; curThreadSize_ &lt; threadSizeThreshHold_) &#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;&gt;&gt;&gt; create new thread...&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºæ–°çš„çº¿ç¨‹å¯¹è±¡</span></span><br><span class="line"><span class="keyword">auto</span> ptr = std::<span class="built_in">make_unique</span>&lt;Thread&gt;(std::<span class="built_in">bind</span>(&amp;ThreadPool::threadFunc, <span class="keyword">this</span>, std::placeholders::_1));</span><br><span class="line"><span class="type">int</span> threadId = ptr-&gt;<span class="built_in">getId</span>();</span><br><span class="line">threads_.<span class="built_in">emplace</span>(threadId, std::<span class="built_in">move</span>(ptr));</span><br><span class="line"><span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">threads_[threadId]-&gt;<span class="built_in">start</span>();</span><br><span class="line"><span class="comment">// ä¿®æ”¹çº¿ç¨‹ä¸ªæ•°ç›¸å…³çš„å˜é‡</span></span><br><span class="line">curThreadSize_++;</span><br><span class="line">idleThreadSize_++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›ä»»åŠ¡çš„Resultå¯¹è±¡</span></span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼€å¯çº¿ç¨‹æ± </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start</span><span class="params">(<span class="type">int</span> initThreadSize = std::thread::hardware_concurrency())</span> </span>&#123;</span><br><span class="line"><span class="comment">// è®¾ç½®çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€</span></span><br><span class="line">isPoolRunning_ = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®°å½•åˆå§‹çº¿ç¨‹ä¸ªæ•°</span></span><br><span class="line">initThreadSize_ = initThreadSize;</span><br><span class="line">curThreadSize_ = initThreadSize;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºçº¿ç¨‹å¯¹è±¡</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; initThreadSize_; i++) &#123;</span><br><span class="line"><span class="comment">// åˆ›å»ºthreadçº¿ç¨‹å¯¹è±¡çš„æ—¶å€™ï¼ŒæŠŠçº¿ç¨‹å‡½æ•°ç»™åˆ°threadçº¿ç¨‹å¯¹è±¡</span></span><br><span class="line"><span class="keyword">auto</span> ptr = std::<span class="built_in">make_unique</span>&lt;Thread&gt;(std::<span class="built_in">bind</span>(&amp;ThreadPool::threadFunc, <span class="keyword">this</span>, std::placeholders::_1));</span><br><span class="line"><span class="type">int</span> threadId = ptr-&gt;<span class="built_in">getId</span>();</span><br><span class="line">threads_.<span class="built_in">emplace</span>(threadId, std::<span class="built_in">move</span>(ptr));</span><br><span class="line"><span class="comment">// threads_.emplace_back(std::move(ptr));</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨æ‰€æœ‰çº¿ç¨‹  std::vector&lt;Thread*&gt; threads_;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; initThreadSize_; i++) &#123;</span><br><span class="line">threads_[i]-&gt;<span class="built_in">start</span>(); <span class="comment">// éœ€è¦å»æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹å‡½æ•°</span></span><br><span class="line">idleThreadSize_++;    <span class="comment">// è®°å½•åˆå§‹ç©ºé—²çº¿ç¨‹çš„æ•°é‡</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">ThreadPool</span>(<span class="type">const</span> ThreadPool&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">ThreadPool&amp; <span class="keyword">operator</span>=(<span class="type">const</span> ThreadPool&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="comment">// å®šä¹‰çº¿ç¨‹å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">threadFunc</span><span class="params">(<span class="type">int</span> threadid)</span> </span>&#123;</span><br><span class="line"><span class="keyword">auto</span> lastTime = std::chrono::<span class="built_in">high_resolution_clock</span>().<span class="built_in">now</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰€æœ‰ä»»åŠ¡å¿…é¡»æ‰§è¡Œå®Œæˆï¼Œçº¿ç¨‹æ± æ‰å¯ä»¥å›æ”¶æ‰€æœ‰çº¿ç¨‹èµ„æº</span></span><br><span class="line"><span class="keyword">for</span> (;;) &#123;</span><br><span class="line">Task task; &#123;</span><br><span class="line"><span class="comment">// å…ˆè·å–é”</span></span><br><span class="line"><span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(taskQueMtx_)</span></span>;</span><br><span class="line"></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;tid:&quot;</span> &lt;&lt; std::this_thread::<span class="built_in">get_id</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;å°è¯•è·å–ä»»åŠ¡...&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">// cachedæ¨¡å¼ä¸‹ï¼Œæœ‰å¯èƒ½å·²ç»åˆ›å»ºäº†å¾ˆå¤šçš„çº¿ç¨‹ï¼Œä½†æ˜¯ç©ºé—²æ—¶é—´è¶…è¿‡60sï¼Œåº”è¯¥æŠŠå¤šä½™çš„çº¿ç¨‹</span></span><br><span class="line"><span class="comment">// ç»“æŸå›æ”¶æ‰ï¼ˆè¶…è¿‡initThreadSize_æ•°é‡çš„çº¿ç¨‹è¦è¿›è¡Œå›æ”¶ï¼‰</span></span><br><span class="line"><span class="comment">// å½“å‰æ—¶é—´ - ä¸Šä¸€æ¬¡çº¿ç¨‹æ‰§è¡Œçš„æ—¶é—´ &gt; 60s</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯ä¸€ç§’ä¸­è¿”å›ä¸€æ¬¡   æ€ä¹ˆåŒºåˆ†ï¼šè¶…æ—¶è¿”å›ï¼Ÿè¿˜æ˜¯æœ‰ä»»åŠ¡å¾…æ‰§è¡Œè¿”å›</span></span><br><span class="line"><span class="comment">// é” + åŒé‡åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">while</span> (taskQue_.<span class="built_in">size</span>() == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="comment">// çº¿ç¨‹æ± è¦ç»“æŸï¼Œå›æ”¶çº¿ç¨‹èµ„æº</span></span><br><span class="line"><span class="keyword">if</span> (!isPoolRunning_) &#123;</span><br><span class="line">threads_.<span class="built_in">erase</span>(threadid); <span class="comment">// std::this_thread::getid()</span></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;threadid:&quot;</span> &lt;&lt; std::this_thread::<span class="built_in">get_id</span>() &lt;&lt; <span class="string">&quot; exit!&quot;</span></span><br><span class="line">&lt;&lt; std::endl;</span><br><span class="line">exitCond_.<span class="built_in">notify_all</span>();</span><br><span class="line"><span class="keyword">return</span>; <span class="comment">// çº¿ç¨‹å‡½æ•°ç»“æŸï¼Œçº¿ç¨‹ç»“æŸ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (poolMode_ == PoolMode::MODE_CACHED) &#123;</span><br><span class="line"><span class="comment">// æ¡ä»¶å˜é‡ï¼Œè¶…æ—¶è¿”å›äº†</span></span><br><span class="line"><span class="keyword">if</span> (std::cv_status::timeout ==</span><br><span class="line">notEmpty_.<span class="built_in">wait_for</span>(lock, std::chrono::<span class="built_in">seconds</span>(<span class="number">1</span>))) &#123;</span><br><span class="line"><span class="keyword">auto</span> now = std::chrono::<span class="built_in">high_resolution_clock</span>().<span class="built_in">now</span>();</span><br><span class="line"><span class="keyword">auto</span> dur = std::chrono::<span class="built_in">duration_cast</span>&lt;std::chrono::seconds&gt;(now - lastTime);</span><br><span class="line"><span class="keyword">if</span> (dur.<span class="built_in">count</span>() &gt;= THREAD_MAX_IDLE_TIME</span><br><span class="line">&amp;&amp; curThreadSize_ &gt; initThreadSize_) &#123;</span><br><span class="line"><span class="comment">// å¼€å§‹å›æ”¶å½“å‰çº¿ç¨‹</span></span><br><span class="line"><span class="comment">// è®°å½•çº¿ç¨‹æ•°é‡çš„ç›¸å…³å˜é‡çš„å€¼ä¿®æ”¹</span></span><br><span class="line"><span class="comment">// æŠŠçº¿ç¨‹å¯¹è±¡ä»çº¿ç¨‹åˆ—è¡¨å®¹å™¨ä¸­åˆ é™¤   æ²¡æœ‰åŠæ³• threadFuncã€Š=ã€‹threadå¯¹è±¡</span></span><br><span class="line"><span class="comment">// threadid =&gt; threadå¯¹è±¡ =&gt; åˆ é™¤</span></span><br><span class="line">threads_.<span class="built_in">erase</span>(threadid); <span class="comment">// std::this_thread::getid()</span></span><br><span class="line">curThreadSize_--;</span><br><span class="line">idleThreadSize_--;</span><br><span class="line"></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;threadid:&quot;</span> &lt;&lt; std::this_thread::<span class="built_in">get_id</span>() &lt;&lt; <span class="string">&quot; exit!&quot;</span></span><br><span class="line">&lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// ç­‰å¾…notEmptyæ¡ä»¶</span></span><br><span class="line">notEmpty_.<span class="built_in">wait</span>(lock);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">idleThreadSize_--;</span><br><span class="line"></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;tid:&quot;</span> &lt;&lt; std::this_thread::<span class="built_in">get_id</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;è·å–ä»»åŠ¡æˆåŠŸ...&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»ä»»åŠ¡é˜Ÿåˆ—ç§å–ä¸€ä¸ªä»»åŠ¡å‡ºæ¥</span></span><br><span class="line">task = taskQue_.<span class="built_in">front</span>();</span><br><span class="line">taskQue_.<span class="built_in">pop</span>();</span><br><span class="line">taskSize_--;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœä¾ç„¶æœ‰å‰©ä½™ä»»åŠ¡ï¼Œç»§ç»­é€šçŸ¥å…¶å®ƒå¾—çº¿ç¨‹æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line"><span class="keyword">if</span> (taskQue_.<span class="built_in">size</span>() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">notEmpty_.<span class="built_in">notify_all</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å–å‡ºä¸€ä¸ªä»»åŠ¡ï¼Œè¿›è¡Œé€šçŸ¥ï¼Œé€šçŸ¥å¯ä»¥ç»§ç»­æäº¤ç”Ÿäº§ä»»åŠ¡</span></span><br><span class="line">notFull_.<span class="built_in">notify_all</span>();</span><br><span class="line">&#125; <span class="comment">// å°±åº”è¯¥æŠŠé”é‡Šæ”¾æ‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“å‰çº¿ç¨‹è´Ÿè´£æ‰§è¡Œè¿™ä¸ªä»»åŠ¡</span></span><br><span class="line"><span class="keyword">if</span> (task != <span class="literal">nullptr</span>) &#123;</span><br><span class="line"><span class="built_in">task</span>(); <span class="comment">// æ‰§è¡Œfunction&lt;void()&gt; </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">idleThreadSize_++;</span><br><span class="line">lastTime = std::chrono::<span class="built_in">high_resolution_clock</span>().<span class="built_in">now</span>(); <span class="comment">// æ›´æ–°çº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡çš„æ—¶é—´</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥poolçš„è¿è¡ŒçŠ¶æ€</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">checkRunningState</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> isPoolRunning_;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">std::unordered_map&lt;<span class="type">int</span>, std::unique_ptr&lt;Thread&gt;&gt; threads_; <span class="comment">// çº¿ç¨‹åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> initThreadSize_;  <span class="comment">// åˆå§‹çš„çº¿ç¨‹æ•°é‡</span></span><br><span class="line"><span class="type">int</span> threadSizeThreshHold_; <span class="comment">// çº¿ç¨‹æ•°é‡ä¸Šé™é˜ˆå€¼</span></span><br><span class="line">std::atomic_int curThreadSize_;<span class="comment">// è®°å½•å½“å‰çº¿ç¨‹æ± é‡Œé¢çº¿ç¨‹çš„æ€»æ•°é‡</span></span><br><span class="line">std::atomic_int idleThreadSize_; <span class="comment">// è®°å½•ç©ºé—²çº¿ç¨‹çš„æ•°é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Taskä»»åŠ¡ =ã€‹ å‡½æ•°å¯¹è±¡</span></span><br><span class="line"><span class="keyword">using</span> Task = std::function&lt;<span class="built_in">void</span>()&gt;;</span><br><span class="line">std::queue&lt;Task&gt; taskQue_; <span class="comment">// ä»»åŠ¡é˜Ÿåˆ—</span></span><br><span class="line">std::atomic_int taskSize_; <span class="comment">// ä»»åŠ¡çš„æ•°é‡</span></span><br><span class="line"><span class="type">int</span> taskQueMaxThreshHold_;  <span class="comment">// ä»»åŠ¡é˜Ÿåˆ—æ•°é‡ä¸Šé™é˜ˆå€¼</span></span><br><span class="line"></span><br><span class="line">std::mutex taskQueMtx_; <span class="comment">// ä¿è¯ä»»åŠ¡é˜Ÿåˆ—çš„çº¿ç¨‹å®‰å…¨</span></span><br><span class="line">std::condition_variable notFull_; <span class="comment">// è¡¨ç¤ºä»»åŠ¡é˜Ÿåˆ—ä¸æ»¡</span></span><br><span class="line">std::condition_variable notEmpty_; <span class="comment">// è¡¨ç¤ºä»»åŠ¡é˜Ÿåˆ—ä¸ç©º</span></span><br><span class="line">std::condition_variable exitCond_; <span class="comment">// ç­‰åˆ°çº¿ç¨‹èµ„æºå…¨éƒ¨å›æ”¶</span></span><br><span class="line"></span><br><span class="line">PoolMode poolMode_; <span class="comment">// å½“å‰çº¿ç¨‹æ± çš„å·¥ä½œæ¨¡å¼</span></span><br><span class="line">std::atomic_bool isPoolRunning_; <span class="comment">// è¡¨ç¤ºå½“å‰çº¿ç¨‹æ± çš„å¯åŠ¨çŠ¶æ€</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿ç¨‹æ± å®ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿ç¨‹æ± æ€»ä½“è®¾è®¡åŠç›¸å…³æ¦‚å¿µ</title>
      <link href="/2023/04/18/thread-pool1/"/>
      <url>/2023/04/18/thread-pool1/</url>
      
        <content type="html"><![CDATA[<h2 id="çº¿ç¨‹æ± "><a class="markdownIt-Anchor" href="#çº¿ç¨‹æ± ">#</a> çº¿ç¨‹æ± </h2><h3 id="çº¿ç¨‹æ± -2"><a class="markdownIt-Anchor" href="#çº¿ç¨‹æ± -2">#</a> çº¿ç¨‹æ± </h3><p>æ± ä¹Ÿç®—æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„é™ä½æ—¶é—´å¼€é”€çš„æ‰‹æ®µäº†å§ï¼Œ</p><p>åœ¨æ­¤æ€»ç»“ä¸€ä¸‹å†™è¿‡çš„çº¿ç¨‹æ± ï¼ŒæŠŠæ¯ä¸€æ­¥æ‹é¡ºäº†ï¼Œå†ç¨å¾®å¤ä¹ ä¸‹å¤šçº¿ç¨‹ç›¸å…³çš„çŸ¥è¯†ã€‚</p><h4 id="å…³äºæœ¬çº¿ç¨‹æ± é¡¹ç›®æè¿°"><a class="markdownIt-Anchor" href="#å…³äºæœ¬çº¿ç¨‹æ± é¡¹ç›®æè¿°">#</a> å…³äºæœ¬çº¿ç¨‹æ± é¡¹ç›®æè¿°ï¼š</h4><ul><li>åŸºäºå¯å˜å‚æ¨¡æ¿ç¼–ç¨‹å’Œå¼•ç”¨æŠ˜å åŸç†ï¼Œå®ç°çº¿ç¨‹æ±  submitTask æ¥å£ï¼Œæ”¯æŒä»»æ„ä»»åŠ¡å‡½æ•°å’Œä»»æ„å‚æ•° çš„ä¼ é€’</li><li>ä½¿ç”¨ future ç±»å‹å®šåˆ¶ submitTask æäº¤ä»»åŠ¡çš„è¿”å›å€¼</li><li>ä½¿ç”¨ map å’Œ queue å®¹å™¨ç®¡ç†çº¿ç¨‹å¯¹è±¡å’Œä»»åŠ¡</li><li>åŸºäºæ¡ä»¶å˜é‡ condition_variable å’Œäº’æ–¥é” mutex å®ç°ä»»åŠ¡æäº¤çº¿ç¨‹å’Œä»»åŠ¡æ‰§è¡Œçº¿ç¨‹é—´</li><li>çš„é€šä¿¡æœºåˆ¶</li><li>æ”¯æŒ fixed å’Œ cached æ¨¡å¼çš„çº¿ç¨‹æ± å®šåˆ¶</li><li>gdb è°ƒè¯•åˆ†æå®šä½æ­»é”é—®é¢˜</li></ul><h4 id="çº¿ç¨‹çš„æ¶ˆè€—"><a class="markdownIt-Anchor" href="#çº¿ç¨‹çš„æ¶ˆè€—">#</a> çº¿ç¨‹çš„æ¶ˆè€—</h4><p>ä¸ºäº†å®Œæˆä»»åŠ¡ï¼Œåˆ›å»ºå¾ˆå¤šçš„çº¿ç¨‹å¯ä»¥å—ï¼Ÿçº¿ç¨‹çœŸçš„æ˜¯è¶Šå¤šè¶Šå¥½ï¼Ÿ</p><ul><li>çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯éƒ½æ˜¯éå¸¸ &quot;é‡&quot; çš„æ“ä½œ</li><li>çº¿ç¨‹æ ˆæœ¬èº«å ç”¨å¤§é‡å†…å­˜</li><li>çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢è¦å ç”¨å¤§é‡æ—¶é—´</li><li>å¤§é‡çº¿ç¨‹åŒæ—¶å”¤é†’ä¼šä½¿ç³»ç»Ÿç»å¸¸å‡ºç°é”¯é½¿çŠ¶è´Ÿè½½æˆ–è€…ç¬é—´è´Ÿè½½é‡å¾ˆå¤§å¯¼è‡´å®•æœº</li></ul><h4 id="çº¿ç¨‹æ± çš„ä¼˜åŠ¿"><a class="markdownIt-Anchor" href="#çº¿ç¨‹æ± çš„ä¼˜åŠ¿">#</a> çº¿ç¨‹æ± çš„ä¼˜åŠ¿</h4><p>æ“ä½œç³»ç»Ÿä¸Šåˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹éƒ½æ˜¯å¾ˆ &quot;é‡&quot; çš„æ“ä½œï¼Œè€—æ—¶è€—æ€§èƒ½éƒ½æ¯”è¾ƒå¤šï¼Œé‚£ä¹ˆåœ¨æœåŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œ å¦‚æœä¸šåŠ¡é‡æ¯”è¾ƒå¤§ï¼Œå®æ—¶çš„å»åˆ›å»ºçº¿ç¨‹ã€æ‰§è¡Œä¸šåŠ¡ã€ä¸šåŠ¡å®Œæˆåé”€æ¯çº¿ç¨‹ï¼Œé‚£ä¹ˆä¼šå¯¼è‡´ç³»ç»Ÿçš„å®æ—¶æ€§èƒ½ é™ä½ï¼Œä¸šåŠ¡çš„å¤„ç†èƒ½åŠ›ä¹Ÿä¼šé™ä½ã€‚ çº¿ç¨‹æ± çš„ä¼˜åŠ¿å°±æ˜¯ï¼ˆæ¯ä¸ªæ± éƒ½æœ‰è‡ªå·±çš„ä¼˜åŠ¿ï¼‰ï¼Œåœ¨æœåŠ¡è¿›ç¨‹å¯åŠ¨ä¹‹åˆï¼Œå°±äº‹å…ˆåˆ›å»ºå¥½çº¿ç¨‹æ± é‡Œé¢çš„çº¿ ç¨‹ï¼Œå½“ä¸šåŠ¡æµé‡åˆ°æ¥æ—¶éœ€è¦åˆ†é…çº¿ç¨‹ï¼Œç›´æ¥ä»çº¿ç¨‹æ± ä¸­è·å–ä¸€ä¸ªç©ºé—²çº¿ç¨‹æ‰§è¡Œ task ä»»åŠ¡å³å¯ï¼Œtask æ‰§è¡Œ å®Œæˆåï¼Œä¹Ÿä¸ç”¨é‡Šæ”¾çº¿ç¨‹ï¼Œè€Œæ˜¯æŠŠçº¿ç¨‹å½’è¿˜åˆ°çº¿ç¨‹æ± ä¸­ç»§ç»­ç»™åç»­çš„ task æä¾›æœåŠ¡ã€‚</p><h4 id="fixedæ¨¡å¼çº¿ç¨‹æ± "><a class="markdownIt-Anchor" href="#fixedæ¨¡å¼çº¿ç¨‹æ± ">#</a> fixed æ¨¡å¼çº¿ç¨‹æ± </h4><p>çº¿ç¨‹æ± é‡Œé¢çš„çº¿ç¨‹ä¸ªæ•°æ˜¯å›ºå®šä¸å˜çš„ï¼Œä¸€èˆ¬æ˜¯ ThreadPool åˆ›å»ºæ—¶æ ¹æ®å½“å‰æœºå™¨çš„ CPU æ ¸å¿ƒæ•°é‡è¿›è¡ŒæŒ‡ å®šã€‚</p><h4 id="cachedæ¨¡å¼çº¿ç¨‹æ± "><a class="markdownIt-Anchor" href="#cachedæ¨¡å¼çº¿ç¨‹æ± ">#</a> cached æ¨¡å¼çº¿ç¨‹æ± </h4><p>çº¿ç¨‹æ± é‡Œé¢çš„çº¿ç¨‹ä¸ªæ•°æ˜¯å¯åŠ¨æ€å¢é•¿çš„ï¼Œæ ¹æ®ä»»åŠ¡çš„æ•°é‡åŠ¨æ€çš„å¢åŠ çº¿ç¨‹çš„æ•°é‡ï¼Œä½†æ˜¯ä¼šè®¾ç½®ä¸€ä¸ªçº¿ç¨‹ æ•°é‡çš„é˜ˆå€¼ï¼ˆçº¿ç¨‹è¿‡å¤šçš„åå¤„ä¸Šé¢å·²ç»è®²è¿‡äº†ï¼‰ï¼Œä»»åŠ¡å¤„ç†å®Œæˆï¼Œå¦‚æœåŠ¨æ€å¢é•¿çš„çº¿ç¨‹ç©ºé—²äº† 60s è¿˜æ²¡ æœ‰å¤„ç†å…¶å®ƒä»»åŠ¡ï¼Œé‚£ä¹ˆå…³é—­çº¿ç¨‹ï¼Œä¿æŒæ± ä¸­æœ€åˆæ•°é‡çš„çº¿ç¨‹å³å¯ã€‚</p><ul><li><p>C++11</p><p>ç»„åˆå’Œç»§æ‰¿ï¼Œå¤šæ€ï¼ŒSTLï¼Œæ™ºèƒ½æŒ‡é’ˆï¼Œå‡½æ•°å¯¹è±¡ï¼Œç»‘å®šå™¨ï¼Œå¯å˜å‚æ¨¡æ¿ç¼–ç¨‹</p></li><li><p>C++11 å¤šçº¿ç¨‹ç¼–ç¨‹</p><p>thread,mutxe,atomic,condition_variable,unique_lock</p></li><li><p>C<ins>17 å’Œ C</ins>20 çš„æ ‡å‡†çš„ä¸€äº›å†…å®¹</p><p>17 çš„ anyï¼Œ 20 çš„ semaphore</p></li><li><p>å¤šçº¿ç¨‹ç†è®º</p><p>å¤šçº¿ç¨‹åŸºæœ¬çŸ¥è¯†ï¼Œçº¿ç¨‹äº’æ–¥ï¼Œçº¿ç¨‹åŒæ­¥ï¼ŒåŸå­æ“ä½œï¼ŒCAS</p></li></ul><h4 id="å¹¶å‘å’Œå¹¶è¡Œ"><a class="markdownIt-Anchor" href="#å¹¶å‘å’Œå¹¶è¡Œ">#</a> å¹¶å‘å’Œå¹¶è¡Œ</h4><ul><li>CPU å•æ ¸</li><li>CPU å¤šæ ¸ã€å¤š CPU</li></ul><h4 id="å¹¶å‘"><a class="markdownIt-Anchor" href="#å¹¶å‘">#</a> å¹¶å‘</h4><p>å•æ ¸ä¸Šï¼Œå¤šä¸ªçº¿ç¨‹å ç”¨ä¸åŒçš„ CPU æ—¶é—´ç‰‡ï¼Œç‰©ç†ä¸Šè¿˜æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼Œä½†æ˜¯ç”±äºæ¯ä¸ªçº¿ç¨‹å ç”¨çš„ CPU æ—¶é—´ ç‰‡éå¸¸çŸ­ï¼ˆæ¯”å¦‚ 10msï¼‰ï¼Œçœ‹èµ·æ¥å°±åƒæ˜¯å¤šä¸ªçº¿ç¨‹éƒ½åœ¨å…±åŒæ‰§è¡Œä¸€æ ·ï¼Œè¿™æ ·çš„åœºæ™¯ç§°ä½œå¹¶å‘ ï¼ˆconcurrentï¼‰ã€‚</p><h4 id="å¹¶è¡Œ"><a class="markdownIt-Anchor" href="#å¹¶è¡Œ">#</a> å¹¶è¡Œ</h4><p>åœ¨å¤šæ ¸æˆ–è€…å¤š CPU ä¸Šï¼Œå¤šä¸ªçº¿ç¨‹æ˜¯åœ¨çœŸæ­£çš„åŒæ—¶æ‰§è¡Œï¼Œè¿™æ ·çš„åœºæ™¯ç§°ä½œå¹¶è¡Œï¼ˆparallelï¼‰ã€‚</p><h3 id="å¤šçº¿ç¨‹çš„ä¼˜åŠ¿"><a class="markdownIt-Anchor" href="#å¤šçº¿ç¨‹çš„ä¼˜åŠ¿">#</a> å¤šçº¿ç¨‹çš„ä¼˜åŠ¿</h3><p>å¤šçº¿ç¨‹ç¨‹åºä¸€å®šå°±å¥½å—ï¼Ÿä¸ä¸€å®šï¼Œè¦çœ‹å…·ä½“çš„åº”ç”¨åœºæ™¯ï¼š</p><h4 id="ioå¯†é›†å‹"><a class="markdownIt-Anchor" href="#ioå¯†é›†å‹">#</a> IO å¯†é›†å‹</h4><p>ç¨‹åºé‡Œé¢æŒ‡ä»¤çš„æ‰§è¡Œï¼Œæ¶‰åŠä¸€äº› IO æ“ä½œ (ä¼šé˜»å¡)</p><p>æ— è®ºæ˜¯ CPU å•æ ¸ã€CPU å¤šæ ¸ã€å¤š CPUï¼Œéƒ½æ˜¯æ¯”è¾ƒé€‚åˆå¤šçº¿ç¨‹ç¨‹åºçš„</p><h4 id="cpuå¯†é›†å‹"><a class="markdownIt-Anchor" href="#cpuå¯†é›†å‹">#</a> CPU å¯†é›†å‹</h4><p>(ç¨‹åºé‡Œé¢çš„æŒ‡ä»¤åšè®¡ç®—ç”¨çš„)</p><ul><li><p>CPU å•æ ¸</p><p>å¤šçº¿ç¨‹å­˜åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ˜¯é¢å¤–çš„èŠ±é”€ï¼Œçº¿ç¨‹è¶Šå¤šä¸Šä¸‹æ–‡åˆ‡æ¢æ‰€èŠ±è´¹çš„é¢å¤–æ—¶é—´ä¹Ÿè¶Šå¤šï¼Œå€’ä¸å¦‚ä¸€ä¸ªçº¿ ç¨‹ä¸€ç›´è¿› è¡Œè®¡ç®—ã€‚</p></li><li><p>CPU å¤šæ ¸ã€å¤š CPU</p><p>å¤šä¸ªçº¿ç¨‹å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œå¯¹ CPU åˆ©ç”¨ç‡å¥½</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> bug </tag>
            
            <tag> çº¿ç¨‹æ± å®ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®åº“è¿æ¥æ± å‹æµ‹</title>
      <link href="/2023/04/17/yace/"/>
      <url>/2023/04/17/yace/</url>
      
        <content type="html"><![CDATA[<h3 id="å‹æµ‹"><a class="markdownIt-Anchor" href="#å‹æµ‹">#</a> å‹æµ‹ï¼š</h3><ul><li>50393us æ•°æ®åº“è¿æ¥æ±  100</li><li>424062us æ™®é€šè¿æ¥ 100</li></ul><p>å¯ä»¥çœ‹å‡ºä½¿ç”¨çº¿ç¨‹æ± åæ•ˆæœæ‹”ç¾¤ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®åº“è¿æ¥æ± å®ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLæ•°æ®åº“è¿æ¥æ± å®ç°</title>
      <link href="/2023/04/17/mysql-mysql-poo2/"/>
      <url>/2023/04/17/mysql-mysql-poo2/</url>
      
        <content type="html"><![CDATA[<h3 id="æ•°æ®åº“è¿æ¥æ± "><a class="markdownIt-Anchor" href="#æ•°æ®åº“è¿æ¥æ± ">#</a> æ•°æ®åº“è¿æ¥æ± </h3><h4 id="æ•°æ®åº“è¿æ¥æ± -2"><a class="markdownIt-Anchor" href="#æ•°æ®åº“è¿æ¥æ± -2">#</a> æ•°æ®åº“è¿æ¥æ± ï¼š</h4><h5 id="å°tips"><a class="markdownIt-Anchor" href="#å°tips">#</a> å° tipsï¼š</h5><p>å…³äºå¤–éƒ¨è·å–è¿æ¥æ± ä¸­çš„ç©ºé—²è¿æ¥ï¼Œåœ¨æ­¤å¯ä»¥ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆæ¥å®Œæˆå†…å­˜ç®¡ç†ï¼Œèƒ½å¤Ÿæ–¹ä¾¿è®¸å¤šã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">connectpool</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//è·å–è¿æ¥æ± å¯¹è±¡å®ä¾‹</span></span><br><span class="line">    <span class="function"><span class="type">static</span> connectpool* <span class="title">getconnectpool</span><span class="params">()</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function">shared_ptr&lt;connection&gt; <span class="title">getConnection</span><span class="params">()</span></span>;<span class="comment">//ç»™å¤–éƒ¨æä¾›ä¸€ä¸ªæ¥å£ï¼Œä»è¿æ¥æ± ä¸­è·å–ä¸€ä¸ªå¯ç”¨çš„ç©ºé—²è¿æ¥</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">loadconfig</span><span class="params">()</span></span>;<span class="comment">//åŠ è½½é…ç½®é¡¹</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">produceConnectionTask</span><span class="params">()</span></span>;<span class="comment">//ç”Ÿäº§æ–°è¿æ¥ </span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">connectpool</span>();<span class="comment">//æ„é€ å‡½æ•°ç§æœ‰åŒ–</span></span><br><span class="line">    string _ip;<span class="comment">//ipåœ°å€</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> _port;<span class="comment">//ç«¯å£å·</span></span><br><span class="line">    string _username;<span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    string _password;<span class="comment">//å¯†ç </span></span><br><span class="line">    string _dbname;<span class="comment">//dbåå­—</span></span><br><span class="line">    <span class="type">int</span> _initsize; <span class="comment">//åˆå§‹è¿æ¥æ•°é‡</span></span><br><span class="line">    <span class="type">int</span> _maxsize;<span class="comment">//æœ€å¤§è¿æ¥æ•°é‡</span></span><br><span class="line">    <span class="type">int</span> _maxIdleTime;<span class="comment">//è¿æ¥æ± æœ€å¤§ç©ºé—²æ—¶é—´</span></span><br><span class="line">    <span class="type">int</span> _connectTimeout;<span class="comment">//è¿æ¥æ± è·å–è¿æ¥çš„è¶…æ—¶æ—¶é—´ </span></span><br><span class="line"></span><br><span class="line">    queue&lt;connection*&gt; _connectqueue; <span class="comment">//å­˜å‚¨mysqlçš„é˜Ÿåˆ—</span></span><br><span class="line">    mutex _queueMutex;<span class="comment">//ç»´æŠ¤è¿æ¥é˜Ÿåˆ—çš„çº¿ç¨‹å®‰å…¨äº’æ–¥é”</span></span><br><span class="line">    atomic_int connectCnt;<span class="comment">//è®°å½•è¿æ¥åˆ›å»ºçš„connectè¿æ¥çš„æ•°é‡</span></span><br><span class="line">    condition_variable cv;<span class="comment">//è®¾ç½®æ¡ä»¶å˜é‡ï¼Œç”¨äºè¿æ¥ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…</span></span><br><span class="line"></span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure><h4 id="æ•°æ®åº“è¿æ¥æ± çš„æ„é€ å‡½æ•°"><a class="markdownIt-Anchor" href="#æ•°æ®åº“è¿æ¥æ± çš„æ„é€ å‡½æ•°">#</a> æ•°æ®åº“è¿æ¥æ± çš„æ„é€ å‡½æ•°ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">connectpool::<span class="built_in">connectpool</span>() &#123;</span><br><span class="line">    <span class="built_in">loadconfig</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; _initsize; i ++) &#123;</span><br><span class="line">        connection*p = <span class="keyword">new</span> <span class="built_in">connection</span>();</span><br><span class="line">        p-&gt;<span class="built_in">connect</span>(_ip, _port, _username, _password, _dbname);</span><br><span class="line">        _connectqueue.<span class="built_in">push</span>(p);</span><br><span class="line">        connectCnt ++;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">//å¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œä½œä¸ºè¿æ¥çš„ç”Ÿäº§è€…</span></span><br><span class="line">    <span class="function">thread <span class="title">produce</span><span class="params">(bind(&amp;connectpool::produceConnectionTask, <span class="keyword">this</span>))</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç”Ÿäº§è€…å‡½æ•°"><a class="markdownIt-Anchor" href="#ç”Ÿäº§è€…å‡½æ•°">#</a> ç”Ÿäº§è€…å‡½æ•°ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">connectpool::produceConnectionTask</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="function">unique_lock&lt;mutex&gt; <span class="title">lock</span><span class="params">(_queueMutex)</span></span>;</span><br><span class="line">        <span class="keyword">while</span> (!_connectqueue.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            cv.<span class="built_in">wait</span>(lock);<span class="comment">//é˜Ÿåˆ—ä¸ç©ºï¼Œç”Ÿäº§è€…è¿›å…¥ç­‰å¾…çŠ¶æ€</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿æ¥æ•°é‡æ²¡åˆ°è¾¾ä¸Šé™ï¼Œç»§ç»­åˆ›å»ºæ–°çš„è¿æ¥</span></span><br><span class="line">        <span class="keyword">if</span>(connectCnt &lt; _maxsize) &#123;</span><br><span class="line">            connection*p = <span class="keyword">new</span> <span class="built_in">connection</span>();</span><br><span class="line">            p-&gt;<span class="built_in">connect</span>(_ip, _port, _username, _password, _dbname);</span><br><span class="line">            _connectqueue.<span class="built_in">push</span>(p);</span><br><span class="line">            connectCnt ++;  </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//é€šçŸ¥æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œå¯ä»¥æ¶ˆè´¹è¿æ¥</span></span><br><span class="line">        cv.<span class="built_in">notify_all</span>();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…å‡½æ•°"><a class="markdownIt-Anchor" href="#æ¶ˆè´¹è€…å‡½æ•°">#</a> æ¶ˆè´¹è€…å‡½æ•°ï¼š</h4><p>æ™ºèƒ½æŒ‡é’ˆåŠ  lambda è¡¨è¾¾å¼</p><p>æ³¨æ„ sleep å’Œ wait-for çš„åŒºåˆ«</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">shared_ptr&lt;connection&gt; <span class="title">connectpool::getConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="function">unique_lock&lt;mutex&gt; <span class="title">lock</span><span class="params">(_queueMutex)</span></span>;</span><br><span class="line">    <span class="keyword">while</span> (_connectqueue.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span>(cv_status::timeout ==  cv.<span class="built_in">wait_for</span>(lock, chrono::<span class="built_in">milliseconds</span>(_connectTimeout))) &#123;</span><br><span class="line">            <span class="keyword">if</span> (_connectqueue.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                <span class="built_in">LOG</span>(<span class="string">&quot;è·å–ç©ºé—²è¿æ¥è¶…æ—¶â€”â€”â€”â€”å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line"><span class="comment">// æ™ºèƒ½æŒ‡é’ˆææ„æ—¶ï¼Œä¼šæŠŠèµ„æºdeleteï¼Œéœ€è¦è‡ªå®šä¹‰ ./run</span></span><br><span class="line">    <span class="function">shared_ptr&lt;connection&gt; <span class="title">sp</span><span class="params">(_connectqueue.front(), </span></span></span><br><span class="line"><span class="params"><span class="function">            [&amp;](connection *pcon) &#123;<span class="comment">//è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨</span></span></span></span><br><span class="line"><span class="params"><span class="function">                unique_lock&lt;mutex&gt; lock(_queueMutex);</span></span></span><br><span class="line"><span class="params"><span class="function">                pcon-&gt;refreshAliveTime();<span class="comment">//åˆ·æ–°ä¸€ä¸‹å¼€å§‹ç©ºé—²èµ·å§‹æ—¶é—´</span></span></span></span><br><span class="line"><span class="params"><span class="function">                _connectqueue.push(pcon);</span></span></span><br><span class="line"><span class="params"><span class="function">            &#125;)</span></span>;</span><br><span class="line">        _connectqueue.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (_connectqueue.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            cv.<span class="built_in">notify_all</span>();<span class="comment">//ç©ºäº†å†é€šçŸ¥ç”Ÿäº§è€…</span></span><br><span class="line">            <span class="keyword">return</span> sp;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤è¶…æ—¶è¿æ¥"><a class="markdownIt-Anchor" href="#åˆ é™¤è¶…æ—¶è¿æ¥">#</a> åˆ é™¤è¶…æ—¶è¿æ¥</h4><p>åº”å½“æ³¨æ„åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåœ¨æ¯æ¬¡åˆ›å»ºå®Œæ•°æ®åº“è¿æ¥æ—¶åˆ·æ–°ä¸€ä¸‹å®šæ—¶å™¨ï¼Œæˆ–è€…æ¶ˆè´¹è€…ä½¿ç”¨å®Œçš„è¿æ¥è¿”è¿˜å›æ•°æ®åº“è¿æ¥æ± æ—¶ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">connectpool::scanConnectionTask</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="comment">//é€šè¿‡sleepæ¨¡æ‹Ÿå®šæ—¶æ•ˆæœ</span></span><br><span class="line">        this_thread::<span class="built_in">sleep_for</span>(chrono::<span class="built_in">seconds</span>(_maxIdleTime));</span><br><span class="line">        <span class="comment">//æ‰«ææ•´ä¸ªé˜Ÿåˆ—ï¼Œé‡Šæ”¾å¤šä½™è¿æ¥</span></span><br><span class="line">        <span class="function">unique_lock&lt;mutex&gt; <span class="title">lock</span><span class="params">(_queueMutex)</span></span>;</span><br><span class="line">        <span class="keyword">while</span> (connectCnt &gt; _initsize) &#123;</span><br><span class="line">            connection *p = _connectqueue.<span class="built_in">front</span>();</span><br><span class="line">            <span class="keyword">if</span> (p-&gt;<span class="built_in">getAliceTime</span>() &gt;= (_maxIdleTime * <span class="number">1000</span>)) &#123;</span><br><span class="line">                _connectqueue.<span class="built_in">pop</span>();</span><br><span class="line">                connectCnt --;</span><br><span class="line">                <span class="keyword">delete</span> p;<span class="comment">//é‡Šæ”¾è¿æ¥</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;<span class="comment">//é˜Ÿå¤´çš„è¿æ¥éƒ½æ²¡è¶…æ—¶ï¼Œåé¢æ›´ä¸ä¼š</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®åº“è¿æ¥æ± å®ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹¶æŸ¥é›†</title>
      <link href="/2023/04/17/acw/"/>
      <url>/2023/04/17/acw/</url>
      
        <content type="html"><![CDATA[<ol start="1250"><li><strong>æ ¼å­æ¸¸æˆ</strong></li></ol><p>Alice å’Œ Bob ç©äº†ä¸€ä¸ªå¤è€çš„æ¸¸æˆï¼šé¦–å…ˆç”»ä¸€ä¸ª nÃ—nï¿½Ã—ï¿½ çš„ç‚¹é˜µï¼ˆä¸‹å›¾ n=3ï¿½=3 ï¼‰ã€‚</p><p>æ¥ç€ï¼Œä»–ä»¬ä¸¤ä¸ªè½®æµåœ¨ç›¸é‚»çš„ç‚¹ä¹‹é—´ç”»ä¸Šçº¢è¾¹å’Œè“è¾¹ï¼š</p><p><img src="https://cdn.acwing.com/media/article/image/2019/12/11/19_9edbcf521b-1.png" class="lazyload placeholder" data-srcset="https://cdn.acwing.com/media/article/image/2019/12/11/19_9edbcf521b-1.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="1.png"></p><p>ç›´åˆ°å›´æˆä¸€ä¸ªå°é—­çš„åœˆï¼ˆé¢ç§¯ä¸å¿…ä¸º 11ï¼‰ä¸ºæ­¢ï¼Œâ€œå°åœˆâ€ çš„é‚£ä¸ªäººå°±æ˜¯èµ¢å®¶ã€‚å› ä¸ºæ£‹ç›˜å®åœ¨æ˜¯å¤ªå¤§äº†ï¼Œä»–ä»¬çš„æ¸¸æˆå®åœ¨æ˜¯å¤ªé•¿äº†ï¼</p><p>ä»–ä»¬ç”šè‡³åœ¨æ¸¸æˆä¸­éƒ½ä¸çŸ¥é“è°èµ¢å¾—äº†æ¸¸æˆã€‚</p><p>äºæ˜¯è¯·ä½ å†™ä¸€ä¸ªç¨‹åºï¼Œå¸®åŠ©ä»–ä»¬è®¡ç®—ä»–ä»¬æ˜¯å¦ç»“æŸäº†æ¸¸æˆï¼Ÿ</p><h4 id="è¾“å…¥æ ¼å¼"><a class="markdownIt-Anchor" href="#è¾“å…¥æ ¼å¼">#</a> è¾“å…¥æ ¼å¼</h4><p>è¾“å…¥æ•°æ®ç¬¬ä¸€è¡Œä¸ºä¸¤ä¸ªæ•´æ•° n å’Œ mã€‚n è¡¨ç¤ºç‚¹é˜µçš„å¤§å°ï¼Œm è¡¨ç¤ºä¸€å…±ç”»äº† m æ¡çº¿ã€‚</p><p>ä»¥å m è¡Œï¼Œæ¯è¡Œé¦–å…ˆæœ‰ä¸¤ä¸ªæ•°å­— (x,y)ï¼Œä»£è¡¨äº†ç”»çº¿çš„èµ·ç‚¹åæ ‡ï¼Œæ¥ç€ç”¨ç©ºæ ¼éš”å¼€ä¸€ä¸ªå­—ç¬¦ï¼Œå‡å¦‚å­—ç¬¦æ˜¯ Dï¼Œåˆ™æ˜¯å‘ä¸‹è¿ä¸€æ¡è¾¹ï¼Œå¦‚æœæ˜¯ R å°±æ˜¯å‘å³è¿ä¸€æ¡è¾¹ã€‚</p><p>è¾“å…¥æ•°æ®ä¸ä¼šæœ‰é‡å¤çš„è¾¹ä¸”ä¿è¯æ­£ç¡®ã€‚</p><h4 id="è¾“å‡ºæ ¼å¼"><a class="markdownIt-Anchor" href="#è¾“å‡ºæ ¼å¼">#</a> è¾“å‡ºæ ¼å¼</h4><p>è¾“å‡ºä¸€è¡Œï¼šåœ¨ç¬¬å‡ æ­¥çš„æ—¶å€™ç»“æŸã€‚</p><p>å‡å¦‚ m æ­¥ä¹‹åä¹Ÿæ²¡æœ‰ç»“æŸï¼Œåˆ™è¾“å‡ºä¸€è¡Œ â€œdrawâ€ã€‚</p><h4 id="æ•°æ®èŒƒå›´"><a class="markdownIt-Anchor" href="#æ•°æ®èŒƒå›´">#</a> æ•°æ®èŒƒå›´</h4><p>1â‰¤nâ‰¤2001â‰¤â‰¤200ï¼Œ<br>1â‰¤mâ‰¤240001â‰¤â‰¤24000</p><h4 id="è¾“å…¥æ ·ä¾‹"><a class="markdownIt-Anchor" href="#è¾“å…¥æ ·ä¾‹">#</a> è¾“å…¥æ ·ä¾‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">3 5</span><br><span class="line">1 1 D</span><br><span class="line">1 1 R</span><br><span class="line">1 2 D</span><br><span class="line">2 1 R</span><br><span class="line">2 2 D</span><br></pre></td></tr></table></figure><h4 id="è¾“å‡ºæ ·ä¾‹"><a class="markdownIt-Anchor" href="#è¾“å‡ºæ ·ä¾‹">#</a> è¾“å‡ºæ ·ä¾‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜ç›®çš„æ€è·¯æ˜¯è¿™æ ·çš„ï¼š</p><p>å°±æ˜¯ç”¨å¹¶æŸ¥é›†çš„æ€è·¯å»åšï¼Œè¿™ä¸ªé¢˜è®©æˆ‘ä»¬åˆ¤æ–­æ˜¯å¦æˆç¯ï¼Œæˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸‹ï¼Œæ€ä¹ˆæ‰èƒ½å‡ºç°ç¯å‘¢ï¼Ÿ</p><p>é‚£å°±æ˜¯å½“è¦æ·»åŠ è¿›å»çš„ä¸¤ä¸ªç‚¹ï¼Œéƒ½åœ¨ä¸€ä¸ªé›†åˆé‡Œï¼</p><p>è¿™æ ·å°±ä¼šå‡ºç°ç¯ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦å°†æ¯æ¬¡æ·»åŠ è¿›å»çš„ç‚¹å­˜åœ¨å¹¶æŸ¥é›†é‡Œï¼Œç„¶åå¯¹æ¯ä¸ªå³å°†æ·»åŠ è¿›å»çš„ä¸¤ä¸ªç‚¹åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦åœ¨ä¸€ä¸ªå¹¶æŸ¥é›†é‡Œå³å¯ï¼Œå¦‚æœåœ¨æˆç¯ä¸”è¿”å›ï¼Œå¦‚æœä¸åœ¨ï¼Œå°†ä¸¤ä¸ªç‚¹æ·»åŠ åˆ°ä¸€ä¸ªå¹¶æŸ¥é›†å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">40010</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>  <span class="title">get</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x*n + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a[x] != x) a[x] = <span class="built_in">find</span>(a[x]);</span><br><span class="line">    <span class="keyword">return</span> a[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n * n; i ++) a[i] = i;<span class="comment">//åˆå§‹åŒ–å¹¶æŸ¥é›†</span></span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i ++ ) &#123;</span><br><span class="line">        <span class="type">int</span> x, y;</span><br><span class="line">        <span class="type">char</span> c;</span><br><span class="line">        cin&gt;&gt;x&gt;&gt;y&gt;&gt;c;</span><br><span class="line">        x --, y--;</span><br><span class="line">        <span class="type">int</span> b = <span class="built_in">get</span>(x, y);</span><br><span class="line">        <span class="type">int</span> d;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">&#x27;D&#x27;</span>) d = <span class="built_in">get</span>(x+<span class="number">1</span>, y);</span><br><span class="line">        <span class="keyword">else</span> d = <span class="built_in">get</span>(x,y+<span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">int</span> pb = <span class="built_in">find</span>(b);</span><br><span class="line">        <span class="type">int</span> pd = <span class="built_in">find</span>(d);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (pb == pd) &#123;</span><br><span class="line">            res = i;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        a[pb] = pd;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!res) cout&lt;&lt;<span class="string">&quot;draw&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">else</span> cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="1252"><li>æ­é…è´­ä¹°</li></ol><p>Joe è§‰å¾—äº‘æœµå¾ˆç¾ï¼Œå†³å®šå»å±±ä¸Šçš„å•†åº—ä¹°ä¸€äº›äº‘æœµã€‚</p><p>å•†åº—é‡Œæœ‰ n æœµäº‘ï¼Œäº‘æœµè¢«ç¼–å·ä¸º 1,2,â€¦,n1,2,â€¦,ï¼Œå¹¶ä¸”æ¯æœµäº‘éƒ½æœ‰ä¸€ä¸ªä»·å€¼ã€‚</p><p>ä½†æ˜¯å•†åº—è€æ¿è·Ÿä»–è¯´ï¼Œä¸€äº›äº‘æœµè¦æ­é…æ¥ä¹°æ‰å¥½ï¼Œæ‰€ä»¥ä¹°ä¸€æœµäº‘åˆ™ä¸è¿™æœµäº‘æœ‰æ­é…çš„äº‘éƒ½è¦ä¹°ã€‚</p><p>ä½†æ˜¯ Joe çš„é’±æœ‰é™ï¼Œæ‰€ä»¥ä»–å¸Œæœ›ä¹°çš„ä»·å€¼è¶Šå¤šè¶Šå¥½ã€‚</p><h4 id="è¾“å…¥æ ¼å¼-2"><a class="markdownIt-Anchor" href="#è¾“å…¥æ ¼å¼-2">#</a> è¾“å…¥æ ¼å¼</h4><p>ç¬¬ 11 è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° nï¼Œmï¼Œwï¼Œè¡¨ç¤ºæœ‰ n æœµäº‘ï¼Œm ä¸ªæ­é…ï¼ŒJoe æœ‰ w çš„é’±ã€‚</p><p>ç¬¬ 2âˆ¼n+12âˆ¼+1 è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ•´æ•° ciï¼Œdi è¡¨ç¤º i æœµäº‘çš„ä»·é’±å’Œä»·å€¼ã€‚</p><p>ç¬¬ n+2âˆ¼n+1+m +2âˆ¼ +1+  è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ•´æ•° uiï¼Œvi  ï¼Œ  ï¼Œè¡¨ç¤ºä¹° ui   å°±å¿…é¡»ä¹° vi  ï¼ŒåŒç†ï¼Œå¦‚æœä¹° vi   å°±å¿…é¡»ä¹° ui  ã€‚</p><h4 id="è¾“å‡ºæ ¼å¼-2"><a class="markdownIt-Anchor" href="#è¾“å‡ºæ ¼å¼-2">#</a> è¾“å‡ºæ ¼å¼</h4><p>ä¸€è¡Œï¼Œè¡¨ç¤ºå¯ä»¥è·å¾—çš„æœ€å¤§ä»·å€¼ã€‚</p><h4 id="æ•°æ®èŒƒå›´-2"><a class="markdownIt-Anchor" href="#æ•°æ®èŒƒå›´-2">#</a> æ•°æ®èŒƒå›´</h4><p>1â‰¤nâ‰¤100001â‰¤ â‰¤10000,<br>0â‰¤mâ‰¤50000â‰¤ â‰¤5000,<br>1â‰¤wâ‰¤100001â‰¤ â‰¤10000,<br>1â‰¤ciâ‰¤50001â‰¤  â‰¤5000,<br>1â‰¤diâ‰¤1001â‰¤  â‰¤100,<br>1â‰¤ui,viâ‰¤n1â‰¤  ,  â‰¤</p><h4 id="è¾“å…¥æ ·ä¾‹-2"><a class="markdownIt-Anchor" href="#è¾“å…¥æ ·ä¾‹-2">#</a> è¾“å…¥æ ·ä¾‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">5 3 10</span><br><span class="line">3 10</span><br><span class="line">3 10</span><br><span class="line">3 10</span><br><span class="line">5 100</span><br><span class="line">10 1</span><br><span class="line">1 3</span><br><span class="line">3 2</span><br><span class="line">4 2</span><br></pre></td></tr></table></figure><h4 id="è¾“å‡ºæ ·ä¾‹-2"><a class="markdownIt-Anchor" href="#è¾“å‡ºæ ·ä¾‹-2">#</a> è¾“å‡ºæ ·ä¾‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜å•Šï¼Œæ€è·¯ä¹Ÿä¸éš¾ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å…ˆè¯»å…¥æ•°æ®ï¼Œç„¶åçœ‹çœ‹æ–°åŠ å…¥çš„ä¸¤æœµäº‘æ˜¯å¦åœ¨ä¸€ä¸ªå¹¶æŸ¥é›†é‡Œé¢ï¼Œå¦‚æœåœ¨çš„è¯ï¼Œæš‚ä¸”ä¸ç®¡ï¼Œå¦‚æœä¸åœ¨çš„è¯ï¼Œæ·»åŠ ä»¥ä¸‹ï¼Œä»·æ ¼ä»·å€¼ä¹Ÿéœ€è¦æ›´æ–°ã€‚</p><p>éšåéå†æ‰€æœ‰çš„äº‘ï¼Œä»…å½“ p [i]==i æ—¶ï¼Œé€‰è¯¥äº‘ï¼ŒåŒ–ä¸ºä¸€ä¸ª 01 èƒŒåŒ…é—®é¢˜ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m, q;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">10010</span>;</span><br><span class="line"><span class="type">int</span> w[N], v[N], p[N], f[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p[x] != x) p[x] = <span class="built_in">find</span>(p[x]);</span><br><span class="line">    <span class="keyword">return</span> p[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m&gt;&gt;q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">        cin&gt;&gt;v[i]&gt;&gt;w[i];</span><br><span class="line">        p[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (m --) &#123;</span><br><span class="line">        <span class="type">int</span> x, y;</span><br><span class="line">        cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">        <span class="type">int</span> pa = <span class="built_in">find</span>(x), pb = <span class="built_in">find</span>(y);</span><br><span class="line">        <span class="keyword">if</span>(pa != pb) &#123;</span><br><span class="line">            v[pb] += v[pa];</span><br><span class="line">            w[pb] += w[pa];</span><br><span class="line">            p[pa] = pb;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i] == i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = q; j &gt;= v[i]; j --) &#123;</span><br><span class="line">                f[j] = <span class="built_in">max</span>(f[j], f[j-v[i]] + w[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;f[q]&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å¹¶æŸ¥é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜day5</title>
      <link href="/2023/04/17/day5/"/>
      <url>/2023/04/17/day5/</url>
      
        <content type="html"><![CDATA[<h4 id="124-äºŒå‰æ ‘ä¸­çš„æœ€å¤§è·¯å¾„å’Œ"><a class="markdownIt-Anchor" href="#124-äºŒå‰æ ‘ä¸­çš„æœ€å¤§è·¯å¾„å’Œ">#</a> <a href="https://leetcode.cn/problems/binary-tree-maximum-path-sum/">124. äºŒå‰æ ‘ä¸­çš„æœ€å¤§è·¯å¾„å’Œ</a></h4><p>äºŒå‰æ ‘ä¸­çš„ è·¯å¾„ è¢«å®šä¹‰ä¸ºä¸€æ¡èŠ‚ç‚¹åºåˆ—ï¼Œåºåˆ—ä¸­æ¯å¯¹ç›¸é‚»èŠ‚ç‚¹ä¹‹é—´éƒ½å­˜åœ¨ä¸€æ¡è¾¹ã€‚åŒä¸€ä¸ªèŠ‚ç‚¹åœ¨ä¸€æ¡è·¯å¾„åºåˆ—ä¸­ è‡³å¤šå‡ºç°ä¸€æ¬¡ ã€‚è¯¥è·¯å¾„ è‡³å°‘åŒ…å«ä¸€ä¸ª èŠ‚ç‚¹ï¼Œä¸”ä¸ä¸€å®šç»è¿‡æ ¹èŠ‚ç‚¹ã€‚</p><p>è·¯å¾„å’Œ æ˜¯è·¯å¾„ä¸­å„èŠ‚ç‚¹å€¼çš„æ€»å’Œã€‚</p><p>ç»™ä½ ä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œè¿”å›å…¶ æœ€å¤§è·¯å¾„å’Œ ã€‚</p><p>è¿™ä¸ªé¢˜å•Šï¼Œå¯¹äºä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ±‚å‡ºå…¶å·¦å³å­©å­çš„è´¡çŒ®åº¦ï¼Œä¸”ä»…å½“è¯¥è´¡çŒ®åº¦å¤§äº 0 æ—¶ï¼Œé€‰è¯¥å­©å­ï¼Œä¸ç„¶ä¸å‚ä¸è´¡çŒ®åº¦è®¡ç®—ï¼Œç„¶åå¯¹äºä¸€ä¸ªèŠ‚ç‚¹çš„è´¡çŒ®åº¦ï¼Œä¸ºå…¶èŠ‚ç‚¹çš„å€¼åŠ ä¸Šå·¦å³å­©å­èŠ‚ç‚¹çš„æœ€å¤§å€¼ï¼Œå°±è¡Œå–½ï¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> res = -INT_MAX;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxgain</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!root) <span class="keyword">return</span> -INT_MAX;</span><br><span class="line">        <span class="type">int</span> r = <span class="built_in">max</span>(<span class="built_in">maxgain</span>(root-&gt;right), <span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> l = <span class="built_in">max</span>(<span class="built_in">maxgain</span>(root-&gt;left), <span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> pp = r + l + root-&gt;val;</span><br><span class="line">        res = <span class="built_in">max</span>(res, pp);</span><br><span class="line">        <span class="keyword">return</span> root-&gt;val + <span class="built_in">max</span>(l ,r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxPathSum</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">maxgain</span>(root);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="48-æ—‹è½¬å›¾åƒ"><a class="markdownIt-Anchor" href="#48-æ—‹è½¬å›¾åƒ">#</a> <a href="https://leetcode.cn/problems/rotate-image/">48. æ—‹è½¬å›¾åƒ</a></h4><p>ç»™å®šä¸€ä¸ª n Ã— n çš„äºŒç»´çŸ©é˜µ matrix è¡¨ç¤ºä¸€ä¸ªå›¾åƒã€‚è¯·ä½ å°†å›¾åƒé¡ºæ—¶é’ˆæ—‹è½¬ 90 åº¦ã€‚</p><p>ä½ å¿…é¡»åœ¨ åŸåœ° æ—‹è½¬å›¾åƒï¼Œè¿™æ„å‘³ç€ä½ éœ€è¦ç›´æ¥ä¿®æ”¹è¾“å…¥çš„äºŒç»´çŸ©é˜µã€‚è¯·ä¸è¦ ä½¿ç”¨å¦ä¸€ä¸ªçŸ©é˜µæ¥æ—‹è½¬å›¾åƒã€‚</p><p>è¿™ä¸ªé¢˜å•Šï¼Œso easy</p><p>åªéœ€è¦å¯¹ç§°ä¸€ä¸‹ï¼Œç„¶åå¯¹è§’çº¿ç¿»è½¬ä¸€ä¸‹ï¼Œç›´æ¥æ‹¿æ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; matrix)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = matrix.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n/<span class="number">2</span>; i ++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j ++) <span class="built_in">swap</span>(matrix[i][j], matrix[n - i - <span class="number">1</span>][j]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; ++j) <span class="built_in">swap</span>(matrix[i][j], matrix[j][i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> lc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>day4</title>
      <link href="/2023/04/15/day4/"/>
      <url>/2023/04/15/day4/</url>
      
        <content type="html"><![CDATA[<h4 id="322-é›¶é’±å…‘æ¢"><a class="markdownIt-Anchor" href="#322-é›¶é’±å…‘æ¢">#</a> <a href="https://leetcode.cn/problems/coin-change/">322. é›¶é’±å…‘æ¢</a></h4><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ coins ï¼Œè¡¨ç¤ºä¸åŒé¢é¢çš„ç¡¬å¸ï¼›ä»¥åŠä¸€ä¸ªæ•´æ•° amount ï¼Œè¡¨ç¤ºæ€»é‡‘é¢ã€‚</p><p>è®¡ç®—å¹¶è¿”å›å¯ä»¥å‡‘æˆæ€»é‡‘é¢æ‰€éœ€çš„ æœ€å°‘çš„ç¡¬å¸ä¸ªæ•° ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•ä¸€ç§ç¡¬å¸ç»„åˆèƒ½ç»„æˆæ€»é‡‘é¢ï¼Œè¿”å› -1 ã€‚</p><p>ä½ å¯ä»¥è®¤ä¸ºæ¯ç§ç¡¬å¸çš„æ•°é‡æ˜¯æ— é™çš„</p><p>DP æ³•</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>=</mo><msub><mi>f</mi><mrow><mi>i</mi><mo>âˆ’</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></msub><mo>+</mo><mn>1</mn><mspace linebreak="newline"></mspace><mtext>å…¶ä¸­</mtext><msub><mi>f</mi><mi>i</mi></msub><mtext>è¡¨ç¤ºæ€»é‡‘é¢ä¸º</mtext><mi>i</mi><mtext>æ—¶çš„æœ€å°ç¡¬å¸æ•°</mtext><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub><mtext>ä¸ºç¬¬</mtext><mi>i</mi><mtext>ä¸ªç¡¬å¸çš„é‡‘é¢æ•°</mtext></mrow><annotation encoding="application/x-tex">f_{i} = f_{i-a[i]} + 1 \\å…¶ä¸­f_{i}è¡¨ç¤ºæ€»é‡‘é¢ä¸ºiæ—¶çš„æœ€å°ç¡¬å¸æ•°,a_{i}ä¸ºç¬¬iä¸ªç¡¬å¸çš„é‡‘é¢æ•°</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight">a</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">å…¶</span><span class="mord cjk_fallback">ä¸­</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">è¡¨</span><span class="mord cjk_fallback">ç¤º</span><span class="mord cjk_fallback">æ€»</span><span class="mord cjk_fallback">é‡‘</span><span class="mord cjk_fallback">é¢</span><span class="mord cjk_fallback">ä¸º</span><span class="mord mathnormal">i</span><span class="mord cjk_fallback">æ—¶</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æœ€</span><span class="mord cjk_fallback">å°</span><span class="mord cjk_fallback">ç¡¬</span><span class="mord cjk_fallback">å¸</span><span class="mord cjk_fallback">æ•°</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">ç¬¬</span><span class="mord mathnormal">i</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">ç¡¬</span><span class="mord cjk_fallback">å¸</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">é‡‘</span><span class="mord cjk_fallback">é¢</span><span class="mord cjk_fallback">æ•°</span></span></span></span></span></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">coinChange</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; coins, <span class="type">int</span> amount)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> Max = amount + <span class="number">1</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dp</span><span class="params">(amount + <span class="number">1</span>, Max)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= amount; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; (<span class="type">int</span>)coins.<span class="built_in">size</span>(); ++j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (coins[j] &lt;= i) &#123;</span><br><span class="line">                    dp[i] = <span class="built_in">min</span>(dp[i], dp[i - coins[j]] + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[amount] &gt; amount ? <span class="number">-1</span> : dp[amount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="17-ç”µè¯å·ç çš„å­—æ¯ç»„åˆ"><a class="markdownIt-Anchor" href="#17-ç”µè¯å·ç çš„å­—æ¯ç»„åˆ">#</a> <a href="https://leetcode.cn/problems/letter-combinations-of-a-phone-number/">17. ç”µè¯å·ç çš„å­—æ¯ç»„åˆ</a></h4><p>ç»™å®šä¸€ä¸ªä»…åŒ…å«æ•°å­— 2-9 çš„å­—ç¬¦ä¸²ï¼Œè¿”å›æ‰€æœ‰å®ƒèƒ½è¡¨ç¤ºçš„å­—æ¯ç»„åˆã€‚ç­”æ¡ˆå¯ä»¥æŒ‰ ä»»æ„é¡ºåº è¿”å›ã€‚</p><p>ç»™å‡ºæ•°å­—åˆ°å­—æ¯çš„æ˜ å°„å¦‚ä¸‹ï¼ˆä¸ç”µè¯æŒ‰é”®ç›¸åŒï¼‰ã€‚æ³¨æ„ 1 ä¸å¯¹åº”ä»»ä½•å­—æ¯ã€‚</p><p>ç”¨ dfs æ¥åšå°±è¡Œäº†</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    string tmp;</span><br><span class="line">    vector&lt;string&gt; board = &#123;<span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;abc&quot;</span>, <span class="string">&quot;def&quot;</span>, <span class="string">&quot;ghi&quot;</span>,<span class="string">&quot;jkl&quot;</span>,<span class="string">&quot;mno&quot;</span>,<span class="string">&quot;pqrs&quot;</span>,<span class="string">&quot;tuv&quot;</span>,<span class="string">&quot;wxyz&quot;</span>&#125;;</span><br><span class="line">    vector&lt;string&gt; ans;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> pos, string digits)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(pos == digits.<span class="built_in">size</span>())&#123;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(tmp);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> num = digits[pos] - <span class="string">&#x27;0&#x27;</span>; <span class="comment">//è¡¨ç¤ºæŒ‰åˆ°äº†é”®ç›˜ä¸Šçš„ç¬¬å‡ ä¸ªé”®</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; board[num].<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">            tmp.<span class="built_in">push_back</span>(board[num][i]);  </span><br><span class="line">            <span class="built_in">dfs</span>(pos + <span class="number">1</span>, digits);  <span class="comment">//é€’å½’ä¸‹ä¸€å±‚</span></span><br><span class="line">            tmp.<span class="built_in">pop_back</span>();      <span class="comment">//å›æº¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">letterCombinations</span><span class="params">(string digits)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(digits.<span class="built_in">size</span>() == <span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">0</span>, digits);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> lc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLæ•°æ®åº“è¿æ¥å®ç°</title>
      <link href="/2023/04/15/mysql-pool1/"/>
      <url>/2023/04/15/mysql-pool1/</url>
      
        <content type="html"><![CDATA[<h4 id="mysqlæ•°æ®åº“è¿æ¥å®ç°"><a class="markdownIt-Anchor" href="#mysqlæ•°æ®åº“è¿æ¥å®ç°">#</a> MySQL æ•°æ®åº“è¿æ¥å®ç°</h4><h4 id="connecth"><a class="markdownIt-Anchor" href="#connecth">#</a> connect.h</h4><p>å®ç°è¿æ¥ï¼Œæ›´æ–°ï¼ŒæŸ¥è¯¢ï¼Œå¯ä»¥åç»­æ·»åŠ å¾ˆå¤š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mysql/mysql.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">connection</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">connection</span>(<span class="comment">/* args */</span>);</span><br><span class="line">    ~<span class="built_in">connection</span>();</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">connect</span><span class="params">(string ip,</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="type">unsigned</span> <span class="type">short</span> port,</span></span></span><br><span class="line"><span class="params"><span class="function">                string user,</span></span></span><br><span class="line"><span class="params"><span class="function">                string hash_password,</span></span></span><br><span class="line"><span class="params"><span class="function">                string dbname</span></span></span><br><span class="line"><span class="params"><span class="function">        )</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">update</span><span class="params">(string sql)</span></span>;</span><br><span class="line">    <span class="function">MYSQL_RES* <span class="title">query</span><span class="params">(string sql)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">/* data */</span></span><br><span class="line">    MYSQL * _conn;<span class="comment">//è¡¨ç¤ºMYSQL Serverçš„ä¸€æ¡è¿æ¥</span></span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>connect.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;public.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;connect.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mysql/mysql.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//g++ -o run  main.cpp connect.cpp -I /usr/include/mysql -lmysqlclient</span></span><br><span class="line">connection::<span class="built_in">connection</span>() &#123;</span><br><span class="line">    _conn = <span class="built_in">mysql_init</span>(<span class="literal">nullptr</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">connection::~<span class="built_in">connection</span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_conn) <span class="built_in">mysql_close</span>(_conn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">connection::connect</span><span class="params">(string ip,</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="type">unsigned</span> <span class="type">short</span> port,</span></span></span><br><span class="line"><span class="params"><span class="function">                string user,</span></span></span><br><span class="line"><span class="params"><span class="function">                string hash_password,</span></span></span><br><span class="line"><span class="params"><span class="function">                string dbname)</span> </span>&#123;</span><br><span class="line">    MYSQL *p = <span class="built_in">mysql_real_connect</span>(_conn, ip.<span class="built_in">c_str</span>(), user.<span class="built_in">c_str</span>(),</span><br><span class="line">    hash_password.<span class="built_in">c_str</span>(), dbname.<span class="built_in">c_str</span>(), port, <span class="literal">nullptr</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p != <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">connection::update</span><span class="params">(std::string sql)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">mysql_query</span>(_conn, sql.<span class="built_in">c_str</span>())) &#123;</span><br><span class="line">         <span class="built_in">LOG</span>(<span class="string">&quot;æ›´æ–°å¤±è´¥:&quot;</span> + sql);</span><br><span class="line">         <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">MYSQL_RES* <span class="title">connection::query</span><span class="params">(string sql)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">mysql_query</span>(_conn, sql.<span class="built_in">c_str</span>())) &#123;</span><br><span class="line">        <span class="built_in">LOG</span>(<span class="string">&quot;æŸ¥è¯¢å¤±è´¥:&quot;</span> + sql);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mysql_use_result</span>(_conn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®åº“è¿æ¥æ± å®ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®åº“è¿æ¥æ± æ¡†æ¶æ„å»º</title>
      <link href="/2023/04/15/mysql-pool/"/>
      <url>/2023/04/15/mysql-pool/</url>
      
        <content type="html"><![CDATA[<h3 id="æ•°æ®åº“è¿æ¥æ± æ¡†æ¶æ„å»º"><a class="markdownIt-Anchor" href="#æ•°æ®åº“è¿æ¥æ± æ¡†æ¶æ„å»º">#</a> æ•°æ®åº“è¿æ¥æ± æ¡†æ¶æ„å»º</h3><p>æŠ€æœ¯ç‚¹ï¼š</p><p>MySQL æ•°æ®åº“ç¼–ç¨‹ã€å•ä¾‹æ¨¡å¼ã€queue é˜Ÿåˆ—å®¹å™¨ã€C++11 å¤šçº¿ç¨‹ã€çº¿ç¨‹äº’æ–¥ã€çº¿ç¨‹åŒæ­¥å’Œ unique_lockã€åŸºäº CAS çš„åŸå­æ•´å½¢ã€æ™ºèƒ½æŒ‡é’ˆ shared_ptrã€lambda è¡¨è¾¾å¼ã€ç”Ÿäº§è€…æ¶ˆè´¹è€…çº¿ç¨‹æ¨¡å‹</p><p>åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œå¤§é‡çš„ TCP ä¸‰æ¬¡æ¡æ‰‹ï¼ŒMySQL Server è¿æ¥è®¤è¯ã€å…³é—­è¿æ¥å›æ”¶èµ„æºå’Œ TCP å››æ¬¡æŒ¥æ‰‹è€—è´¹çš„æ€§èƒ½æ—¶é—´å¾ˆæ˜æ˜¾ï¼Œå¢åŠ è¿æ¥è¯å°±æ˜¯ä¸ºäº†å‡å°‘è¿™ä¸€éƒ¨åˆ†çš„æ€§èƒ½æŸè€—ã€‚</p><p><strong>å®ç°åŠŸèƒ½ï¼š</strong></p><p><strong>åˆå§‹è¿æ¥é‡</strong></p><p><strong>æœ€å¤§è¿æ¥é‡</strong></p><p><strong>æœ€å¤§ç©ºé—²æ—¶é—´</strong></p><p><strong>è¿æ¥è¶…æ—¶æ—¶é—´</strong></p><p>ä¸»è¦å®ç°ä¸Šè¿°å››ä¸ªåŠŸèƒ½</p><p><strong>è®¾è®¡æ€è·¯ï¼š</strong></p><ul><li>è¿æ¥æ± åªéœ€è¦ä¸€ä¸ªå®ä¾‹ï¼Œæ‰€ä»¥ ConnectionPool ä»¥å•ä¾‹æ¨¡å¼è®¾è®¡</li><li>ä» ConnectionPool ä¸­å¯ä»¥è·å¾—å’Œ MySQL è¿æ¥çš„ Connection</li><li>ç©ºé—²è¿æ¥ Connection å…¨éƒ¨ç»´æŠ¤åœ¨ä¸€ä¸ªçº¿ç¨‹å®‰å…¨åœ° Connection é˜Ÿåˆ—ä¸­ï¼Œä½¿ç”¨çº¿ç¨‹äº’æ–¥é”ä¿è¯é˜Ÿåˆ—çš„çº¿ç¨‹å®‰å…¨</li><li>å¦‚æœ Connection é˜Ÿåˆ—ä¸ºç©ºï¼Œéœ€è¦å†è·å–è¿æ¥ï¼Œæ­¤æ—¶åŠ¨æ€åˆ›å»ºè¿æ¥ï¼Œä¸Šé™æ•°é‡æ˜¯ maxSize</li><li>é˜Ÿåˆ—ä¸­ç©ºé—²è¿æ¥æ—¶é—´è¶…è¿‡ maxIdleTime çš„å°±è¦è¢«é‡Šæ”¾æ‰ï¼Œåªä¿ç•™åˆå§‹çš„ initSize å°±å¯ä»¥äº†ï¼Œè¿™ä¸ªåŠŸèƒ½äº¤ç”±ç‹¬ç«‹çš„çº¿ç¨‹å»åš</li><li>å¦‚æœ Connection é˜Ÿåˆ—ä¸ºç©ºï¼Œè€Œæ­¤æ—¶è¿æ¥çš„æ•°é‡å·²è¾¾ä¸Šçº¿ maxSizeï¼Œé‚£ä¹ˆç­‰å¾… Connection TimeOut æ—¶é—´å¦‚æœè¿˜è·å–ä¸åˆ°ç©ºé—²çš„è¿æ¥ï¼Œé‚£ä¹ˆè·å–è¿æ¥å¤±è´¥ï¼Œæ­¤å¤„ Connection é˜Ÿåˆ—è·å–ç©ºé—²è¿æ¥ï¼Œå¯ä»¥ä½¿ç”¨å¸¦è¶…æ—¶æ—¶é—´çš„ mutex äº’æ–¥é”æ¥å®ç°è¿æ¥è¶…æ—¶æ—¶é—´</li><li>ç”¨æˆ·è·å–çš„è¿æ¥ç”¨ shared_ptr æ™ºèƒ½æŒ‡é’ˆæ¥ç®¡ç†ï¼Œç”¨ lambda è¡¨è¾¾å¼å®šåˆ¶è¿æ¥é‡Šæ”¾çš„åŠŸèƒ½</li><li>è¿æ¥çš„ç”Ÿäº§å’Œè¿æ¥çš„æ¶ˆè´¹é‡‡ç”¨ç”Ÿäº§è€…æ¶ˆè´¹è€…çº¿ç¨‹æ¨¡å‹è®¾è®¡ï¼Œä½¿ç”¨çº¿ç¨‹é—´çš„åŒæ­¥é€šä¿¡æœºåˆ¶æ¡ä»¶å˜é‡å’Œäº’æ–¥é”</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®åº“è¿æ¥æ± å®ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºæ•°æ®åº“è¿æ¥æ± é‡åˆ°çš„ä¸€äº›é—®é¢˜</title>
      <link href="/2023/04/15/problem1/"/>
      <url>/2023/04/15/problem1/</url>
      
        <content type="html"><![CDATA[<h3 id="å…³äºæ•°æ®åº“è¿æ¥æ± é‡åˆ°çš„ä¸€äº›é—®é¢˜"><a class="markdownIt-Anchor" href="#å…³äºæ•°æ®åº“è¿æ¥æ± é‡åˆ°çš„ä¸€äº›é—®é¢˜">#</a> å…³äºæ•°æ®åº“è¿æ¥æ± é‡åˆ°çš„ä¸€äº›é—®é¢˜</h3><p>é¦–å…ˆï¼Œè¦è®°å¾—ç»‘ mysql çš„åº“ã€‚</p><p>g++ -o run  main.cpp connect.cpp -I /usr/include/mysql -lmysqlclient</p><p>å¦åˆ™ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œä»…ä»…èƒ½å¯¼å…¥æ˜¯ä¸è¡Œçš„ã€‚</p><p>å…¶æ¬¡æ˜¯å…³äº mysql çš„æŒ‡ä»¤å­¦ä¹ ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SHOW DATABASES;</span><br><span class="line">CREATE DATABASES;</span><br><span class="line">USE test_db;</span><br><span class="line">CREATE TABLE &lt;è¡¨å&gt; ([è¡¨å®šä¹‰é€‰é¡¹])[è¡¨é€‰é¡¹][åˆ†åŒºé€‰é¡¹];</span><br><span class="line">SHOW TABLES;</span><br></pre></td></tr></table></figure><p>å› ä¸ºä¸ç†Ÿæ‚‰ mysql æäº†å¥½å¤šä½çº§é”™è¯¯ï¼Œå“­æ™•ã€‚</p><h3 id="å…³äºç ´bug"><a class="markdownIt-Anchor" href="#å…³äºç ´bug">#</a> å…³äºç ´ bug</h3><h4 id="segmentation-fault-core-dumped"><a class="markdownIt-Anchor" href="#segmentation-fault-core-dumped">#</a> Segmentation fault (core dumped)</h4><p>åœ¨æœ¬é—®é¢˜åœ¨ä¸­æ˜¯æŒ‡é’ˆå‡ºé—®é¢˜äº† qaq</p><p>æ’æŸ¥äº†åŠå¤©</p><p>é€šè¿‡æŸ¥èµ„æ–™å­¦åˆ°äº† gdb è°ƒè¯•çš„ä¸€äº›æ–¹æ³•æ¥åˆ¤æ–­æ˜¯ä»€ä¹ˆé—®é¢˜</p><h4 id="ç„¶åå°±æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿è¡Œä¹‹åä¸€ç›´é˜»å¡"><a class="markdownIt-Anchor" href="#ç„¶åå°±æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿è¡Œä¹‹åä¸€ç›´é˜»å¡">#</a> ç„¶åå°±æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿è¡Œä¹‹åä¸€ç›´é˜»å¡</h4><p>æ’æŸ¥åˆ°è¿™ä¸ªåœ°æ–¹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (_connectqueue.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            cv.<span class="built_in">notify_all</span>();<span class="comment">//ç©ºäº†å†é€šçŸ¥ç”Ÿäº§è€…</span></span><br><span class="line">            <span class="keyword">return</span> sp;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>è¿™å¯ä¸è¡Œï¼<br>å±…ç„¶æŠŠè¿”å›å€¼æ”¾åˆ°å‡½æ•°é‡Œé¢äº†æˆ‘çš„é”™æˆ‘çš„é”™</p><p>æ’æŸ¥åŠå¤©ï¼Œéš¾å—æ­»ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®åº“è¿æ¥æ± å®ç° </tag>
            
            <tag> bug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>unix_fifo</title>
      <link href="/2023/04/14/unix-fifo/"/>
      <url>/2023/04/14/unix-fifo/</url>
      
        <content type="html"><![CDATA[<h3 id="ç®¡é“å’Œfifo"><a class="markdownIt-Anchor" href="#ç®¡é“å’Œfifo">#</a> ç®¡é“å’Œ FIFO</h3><p><strong>ä»å›¾ 4-3 åˆ° 4-4ã€‚å¦‚æœå­è¿›ç¨‹æ²¡æœ‰æ‰§è¡Œ close (fd [1])ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</strong></p><img src="C:\Users\15597\AppData\Roaming\Typora\typora-user-images\image-20230410194658129.png" class="lazyload placeholder" data-srcset="C:\Users\15597\AppData\Roaming\Typora\typora-user-images\image-20230410194658129.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230410194658129" style="zoom:50%;" /><img src="C:\Users\15597\AppData\Roaming\Typora\typora-user-images\image-20230410195558952.png" class="lazyload placeholder" data-srcset="C:\Users\15597\AppData\Roaming\Typora\typora-user-images\image-20230410195558952.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230410195558952" style="zoom:50%;" /><p>å½“çˆ¶è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œå¦‚æœå­è¿›ç¨‹ä¸­ fd [1] å¤„äºæ‰“å¼€çŠ¶æ€ï¼Œé‚£ä¹ˆå­è¿›ç¨‹å¯¹ fd [0] çš„ read ä¸ä¼šè¿”å›æ–‡ä»¶ç»“æŸç¬¦ï¼Œå› ä¸º fd [1] åœ¨å­è¿›ç¨‹ä¸­ä»ç„¶æ‰“å¼€ã€‚åœ¨å­è¿›ç¨‹ä¸­å…³é—­ fd [1] ä¿è¯ä¸€æ—¦çˆ¶è¿›ç¨‹ç»ˆæ­¢ï¼Œå®ƒçš„æ‰€æœ‰æè¿°ç¬¦å³å…³é—­ï¼Œä»è€Œä½¿å¾—å­è¿›ç¨‹å¯¹ fd [0] çš„ read è¿”å› 0.</p><p><strong>å¦‚æœè¦æ‰“å¼€ä¸€ä¸ªå·²æœ‰çš„ FIFO æˆ–è€…åˆ›å»ºä¸€ä¸ªæ–°çš„ FIFOï¼Œåº”è¯¥è°ƒç”¨ mkfifoï¼Œæ£€æŸ¥æ˜¯å¦è¿”å› EEXIST é”™è¯¯ï¼Œè‹¥æ˜¯è°ƒç”¨ open, å¦‚æœå…ˆè°ƒç”¨ openï¼Œå½“ä¸åœ¨æ‰€æœŸæœ›çš„ FIFO æ—¶ï¼Œå†è°ƒç”¨ mkfifoï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</strong></p><p>å¦‚æœè°ƒç”¨å…³ç³»åäº†ï¼Œå¦å¤–æŸä¸ªè¿›ç¨‹å°±æœ‰å¯èƒ½åœ¨æœ¬è¿›ç¨‹çš„ opne å’Œ makifo ä¹‹é—´åˆ›å»ºæœ¬è¿›ç¨‹éœ€è¦çš„ FIFO, ç»“æœå¯¼è‡´æœ¬è¿›ç¨‹çš„ FIFO åˆ›å»ºå¤±è´¥ã€‚</p><p><strong>è°ƒç”¨ open æ—¶ï¼Œå¦‚æœå…¶ä¸­æ‰§è¡Œå‘½ä»¤çš„ shell ç¢°åˆ°é”™è¯¯ï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</strong></p><img src="C:\Users\15597\AppData\Roaming\Typora\typora-user-images\image-20230410201230603.png" class="lazyload placeholder" data-srcset="C:\Users\15597\AppData\Roaming\Typora\typora-user-images\image-20230410201230603.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230410201230603"  /><p><strong>é’ˆå¯¹æœåŠ¡å™¨çš„ FIFO çš„ open å»æ‰ï¼ŒéªŒè¯ä¸€ä¸‹è¿™å¯¼è‡´å½“ä¸å†æœ‰å®¢æˆ·å­˜åœ¨æ—¶ï¼ŒæœåŠ¡å™¨å³ç»ˆæ­¢</strong></p><p><img src="C:%5CUsers%5C15597%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230410201315663.png" class="lazyload placeholder" data-srcset="C:%5CUsers%5C15597%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230410201315663.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230410201315663"></p><p><strong>åœ¨å›¾ 4-23 ä¸­ï¼Œå½“æœåŠ¡å™¨å¯åŠ¨åï¼Œå®ƒé˜»å¡åœ¨è‡ªå·±çš„ç¬¬ä¸€ä¸ª open è°ƒç”¨ä¸­ï¼ŒçŸ¥é“å®¢æˆ·çš„ç¬¬ä¸€ä¸ª open æ‰“å¼€åŒä¸€ä¸ª FIFO ç”¨äºå†™ä¸ºæ­¢ã€‚æˆ‘ä»¬åº”è¯¥æ€ä¹ˆæ‰èƒ½ç»•è¿‡è¿™æ ·çš„é˜»å¡ï¼Œä½¿å¾—ä¸¤ä¸ª open éƒ½ç«‹å³è¿”å›ï¼Œè½¬è€Œé˜»å¡åœ¨é¦–æ¬¡è°ƒç”¨ readline ä¸Šï¼Ÿ</strong></p><p>å°†ç¬¬ä¸€ä¸ª open è°ƒç”¨æ”¹ä½éé˜»å¡</p><p><strong>å¦‚æœå›¾ 4-24 ä¸­çš„å®¢æˆ·ç¨‹åºå¯¹æ¢å…¶ä¸¤ä¸ª open è°ƒç”¨çš„é¡ºåºï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</strong></p><p>ä¼šå‘ç”Ÿæ­»é”</p><p><img src="C:%5CUsers%5C15597%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230410201329799.png" class="lazyload placeholder" data-srcset="C:%5CUsers%5C15597%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230410201329799.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230410201329799"></p><p><strong>ä¸ºä»€ä¹ˆåœ¨è¯»è¿›ç¨‹å…³é—­ç®¡é“æˆ– FIFO ä¹‹åç»™å†™è¿›ç¨‹äº§ç”Ÿä¸€ä¸ªä¿¡å·ï¼Œè€Œä¸ä¼šåœ¨å†™è¿›ç¨‹å…³é—­ç®¡é“æˆ– FIFO ä¹‹åç»™è¯»è¿›ç¨‹äº§ç”Ÿä¸€ä¸ªä¿¡å·ï¼Ÿ</strong></p><p>å†™è¿›ç¨‹å…³é—­ç®¡é“æˆ– FIFO çš„ä¿¡æ¯é€šè¿‡æ–‡ä»¶ç»“æŸç¬¦ä¼ é€’ç»™è¯»è¿›ç¨‹ã€‚</p><p><strong>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œç¡®å®š fstat æ˜¯å¦ä»¥ stat ç»“æ„çš„ st_size æˆå‘˜çš„å½¢å¼è¿”å›å½“å‰åœ¨æŸä¸ª FIFO ä¸­çš„æ•°æ®å­—èŠ‚æ•°</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="comment">// ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œç¡®å®šfstatæ˜¯å¦ä»¥statç»“æ„çš„st_sizeæˆå‘˜çš„å½¢</span></span><br><span class="line"><span class="comment">// å¼è¿”å›å½“å‰åœ¨æŸä¸ªFIFOä¸­çš„æ•°æ®å­—èŠ‚æ•°</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> fd[<span class="number">2</span>];</span><br><span class="line">    <span class="type">char</span> buff[<span class="number">7</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">stat</span> info;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* data */</span></span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> argv[] = <span class="string">&quot;sb&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">mkfifo</span>(argv, S_IRUSR|S_IWUSR|S_IRGRP|S_IROTH) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;create fifo error\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    fd[<span class="number">0</span>] = <span class="built_in">open</span>(argv, O_RDONLY | O_NONBLOCK);</span><br><span class="line">    fd[<span class="number">1</span>] = <span class="built_in">open</span>(argv, O_WRONLY | O_NONBLOCK);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fstat</span>(fd[<span class="number">0</span>], &amp;info);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;fd[0]: st_size = %ld\n&quot;</span>, (<span class="type">long</span>) info.st_size);</span><br><span class="line">    <span class="built_in">fstat</span>(fd[<span class="number">1</span>], &amp;info);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;fd[1]: st_size = %ld\n&quot;</span>, (<span class="type">long</span>) info.st_size);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">write</span>(fd[<span class="number">1</span>], &amp;buff, <span class="built_in">sizeof</span>(buff));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fstat</span>(fd[<span class="number">0</span>], &amp;info);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;fd[0]: st_size = %ld\n&quot;</span>, (<span class="type">long</span>) info.st_size);</span><br><span class="line">    <span class="built_in">fstat</span>(fd[<span class="number">1</span>], &amp;info);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;fd[1]: st_size = %ld\n&quot;</span>, (<span class="type">long</span>) info.st_size);</span><br><span class="line">    <span class="built_in">close</span>(fd[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">close</span>(fd[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨ ulimit -a æŸ¥çœ‹å¾—åˆ°</p><p><img src="C:%5CUsers%5C15597%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230414212714481.png" class="lazyload placeholder" data-srcset="C:%5CUsers%5C15597%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230414212714481.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230414212714481"></p><p>ä»£ç è¿è¡Œå¾—åˆ°</p><p><img src="C:%5CUsers%5C15597%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230414212735466.png" class="lazyload placeholder" data-srcset="C:%5CUsers%5C15597%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230414212735466.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230414212735466"></p><p>å› æ­¤å¹¶ä¸æ˜¯æŸä¸ª FIFO ä¸­çš„æ•°æ®å­—èŠ‚æ•°</p><p>create fifo error æ˜¯å› ä¸ºä¹‹å‰ä»¥åŠåˆ›å»ºè¿‡äº†ã€‚</p><p><strong>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œä»¥ç¡®å®šåœ¨ä¸ºä¸€ä¸ªè¯»å‡ºç«¯å·²å…³é—­çš„ç®¡é“æè¿°ç¬¦é€‰æ‹©å¯å†™æ¡ä»¶æ—¶ select è¿”å›çš„å†…å®¹ã€‚</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> fd[<span class="number">2</span>], n;</span><br><span class="line">    <span class="type">pid_t</span> childpid;</span><br><span class="line">    fd_set wset;</span><br><span class="line">    <span class="built_in">pipe</span>(fd);</span><br><span class="line">    <span class="keyword">if</span> ( (childpid == fork()) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;child closing pipe read description \n&quot;</span>);</span><br><span class="line">        <span class="built_in">close</span>(fd[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">sleep</span>(<span class="number">6</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">close</span>(fd[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">sleep</span>(<span class="number">3</span>);</span><br><span class="line">    <span class="built_in">FD_ZERO</span>(&amp;wset);</span><br><span class="line">    <span class="built_in">FD_SET</span>(fd[<span class="number">1</span>], &amp;wset);</span><br><span class="line"></span><br><span class="line">    n = <span class="built_in">select</span>(fd[<span class="number">1</span>]+<span class="number">1</span>, <span class="literal">NULL</span>, &amp;wset, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;select returned %d\n&quot;</span>, n);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">FD_ISSET</span>(fd[<span class="number">1</span>], &amp;wset)) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;fd[1] writable\n&quot;</span>);</span><br><span class="line">        <span class="built_in">write</span>(fd[<span class="number">1</span>], <span class="string">&quot;hello&quot;</span>, <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="C:%5CUsers%5C15597%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230414214217555.png" class="lazyload placeholder" data-srcset="C:%5CUsers%5C15597%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230414214217555.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="image-20230414214217555"></p>]]></content>
      
      
      
        <tags>
            
            <tag> UNIX </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜day3</title>
      <link href="/2023/04/14/day3/"/>
      <url>/2023/04/14/day3/</url>
      
        <content type="html"><![CDATA[<h4 id="94-äºŒå‰æ ‘çš„ä¸­åºéå†"><a class="markdownIt-Anchor" href="#94-äºŒå‰æ ‘çš„ä¸­åºéå†">#</a> <a href="https://leetcode.cn/problems/binary-tree-inorder-traversal/">94. äºŒå‰æ ‘çš„ä¸­åºéå†</a></h4><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹  <code>root</code>  ï¼Œè¿”å› <em>å®ƒçš„ <strong>ä¸­åº</strong> éå†</em> ã€‚</p><p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå¼€å¹²ï¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">middle_sort</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!root) <span class="keyword">return</span> ;</span><br><span class="line">        <span class="built_in">middle_sort</span>(root-&gt;left);</span><br><span class="line">        res.<span class="built_in">push_back</span>(root-&gt;val);</span><br><span class="line">        <span class="built_in">middle_sort</span>(root-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">inorderTraversal</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">middle_sort</span>(root);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="114-äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨"><a class="markdownIt-Anchor" href="#114-äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨">#</a> <a href="https://leetcode.cn/problems/flatten-binary-tree-to-linked-list/">114. äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨</a></h4><p>ç»™ä½ äºŒå‰æ ‘çš„æ ¹ç»“ç‚¹ root ï¼Œè¯·ä½ å°†å®ƒå±•å¼€ä¸ºä¸€ä¸ªå•é“¾è¡¨ï¼š</p><p>å±•å¼€åçš„å•é“¾è¡¨åº”è¯¥åŒæ ·ä½¿ç”¨ TreeNode ï¼Œå…¶ä¸­ right å­æŒ‡é’ˆæŒ‡å‘é“¾è¡¨ä¸­ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼Œè€Œå·¦å­æŒ‡é’ˆå§‹ç»ˆä¸º null ã€‚<br>å±•å¼€åçš„å•é“¾è¡¨åº”è¯¥ä¸äºŒå‰æ ‘ å…ˆåºéå† é¡ºåºç›¸åŒã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">flatten</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!root) <span class="keyword">return</span> ;</span><br><span class="line">        TreeNode* l = root-&gt;left;</span><br><span class="line">        <span class="keyword">if</span> (l) &#123;</span><br><span class="line">            <span class="keyword">while</span> (l-&gt;right) l = l-&gt;right;</span><br><span class="line">            l-&gt;right = root-&gt;right;</span><br><span class="line">            root-&gt;right = root-&gt;left;</span><br><span class="line">            root-&gt;left = <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">flatten</span>(root-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜å•Šï¼Œå…ˆå°†å·¦å­æ ‘æ‹¿åˆ°å³è¾¹ï¼Œå†å¯¹å³è¾¹é€’å½’å³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> lc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>qndxx</title>
      <link href="/2023/04/13/qndxx/"/>
      <url>/2023/04/13/qndxx/</url>
      
        <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> anti_useragent <span class="keyword">import</span> UserAgent</span><br><span class="line"></span><br><span class="line">openId = <span class="string">&quot;&quot;</span></span><br><span class="line">current_path = os.getcwd()</span><br><span class="line">f = <span class="built_in">open</span>(current_path + <span class="string">&#x27;/&#x27;</span> + <span class="string">&#x27;log.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeHeader</span>(<span class="params">openid=openId</span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json, text/javascript, */*; q=0.01&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh-Hans;q=0.9&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json;charset=UTF-8&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;JSESSIONID=&#x27;</span> + secrets.token_urlsafe(<span class="number">40</span>),</span><br><span class="line">        <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;www.jxqingtuan.cn&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;http://www.jxqingtuan.cn&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;http://www.jxqingtuan.cn/html/h5_index.html&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: UserAgent(platform=<span class="string">&quot;iphone&quot;</span>).wechat,</span><br><span class="line">        <span class="string">&#x27;X-Requested-With&#x27;</span>: <span class="string">&#x27;XMLHttpRequest&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checkConfig</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(cardNo) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;cardNoå¯¹åº”ç¬¬äº”è¡Œæ•°æ®ï¼Œä¸å¯ä¸ºç©º&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(nid) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;cardNoæ˜¯å›¢å§”ç»„ç»‡IDï¼Œä¸å¯ä¸ºç©º&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line">    <span class="comment"># info = json.dumps(getIDInfo())</span></span><br><span class="line">    res = getIDInfo()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(res) != <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å›¢å§”ç»„ç»‡idå¼‚å¸¸ï¼Œæ‚¨ä¼¼ä¹è·å–é”™äº†&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getIDInfo</span>():</span><br><span class="line">    url = <span class="string">&quot;http://www.jxqingtuan.cn/pub/vol/config/organization?pid=&quot;</span> + nid</span><br><span class="line">    res = json.loads(requests.get(url, headers=makeHeader()).text)</span><br><span class="line">    <span class="keyword">if</span> res.get(<span class="string">&quot;status&quot;</span>) == <span class="number">200</span>:</span><br><span class="line">        <span class="keyword">return</span> res.get(<span class="string">&quot;result&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æŸ¥è¯¢ç»„ç»‡å¯¼è‡´æœªçŸ¥é”™è¯¯ï¼š&quot;</span> + res.text)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getCourse</span>():</span><br><span class="line">    url = <span class="string">&quot;http://www.jxqingtuan.cn/pub/vol/volClass/current&quot;</span></span><br><span class="line">    CourseJson = requests.get(url, headers=makeHeader()).json()</span><br><span class="line">    Course = CourseJson.get(<span class="string">&quot;result&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è¯¾ç¨‹idï¼š&quot;</span> + Course.get(<span class="string">&quot;id&quot;</span>))</span><br><span class="line">        f.write(<span class="string">&quot;è¯¾ç¨‹idï¼š&quot;</span> + Course.get(<span class="string">&quot;id&quot;</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è¯¾ç¨‹åç§°ï¼š&quot;</span> + Course.get(<span class="string">&quot;title&quot;</span>))</span><br><span class="line">        f.write(<span class="string">&quot;è¯¾ç¨‹åç§°ï¼š&quot;</span> + Course.get(<span class="string">&quot;title&quot;</span>))</span><br><span class="line">        <span class="keyword">return</span> Course.get(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æŸ¥è¯¢è¯¾ç¨‹è‡´æœªçŸ¥é”™è¯¯&quot;</span>)</span><br><span class="line">        f.write(<span class="string">&quot;æŸ¥è¯¢è¯¾ç¨‹è‡´æœªçŸ¥é”™è¯¯&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getStudy</span>(<span class="params">course, nid, subOrg, cardNo</span>):</span><br><span class="line">    url = <span class="string">&quot;http://www.jxqingtuan.cn/pub/vol/volClass/join?accessToken=&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(subOrg) &gt; <span class="number">0</span>:</span><br><span class="line">        data = &#123;<span class="string">&quot;course&quot;</span>: course, <span class="string">&quot;subOrg&quot;</span>: subOrg, <span class="string">&quot;nid&quot;</span>: nid, <span class="string">&quot;cardNo&quot;</span>: cardNo&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = &#123;<span class="string">&quot;course&quot;</span>: course, <span class="string">&quot;subOrg&quot;</span>: <span class="literal">None</span>, <span class="string">&quot;nid&quot;</span>: nid, <span class="string">&quot;cardNo&quot;</span>: cardNo&#125;</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    res = json.loads(</span><br><span class="line">        (requests.post(url=url, data=json.dumps(data, ensure_ascii=<span class="literal">False</span>).encode(<span class="string">&#x27;utf-8&#x27;</span>), headers=makeHeader())).text)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    <span class="keyword">if</span> res.get(<span class="string">&quot;status&quot;</span>) == <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(cardNo + <span class="string">&quot;å¤§å­¦ä¹ æˆåŠŸï¼&quot;</span>)</span><br><span class="line">        f.write(cardNo + <span class="string">&quot;å¤§å­¦ä¹ æˆåŠŸï¼&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æäº¤å¤§å­¦ä¹ å¯¼è‡´æœªçŸ¥é”™è¯¯ï¼š&quot;</span> + res.text)</span><br><span class="line">        f.write(<span class="string">&quot;æäº¤å¤§å­¦ä¹ å¯¼è‡´æœªçŸ¥é”™è¯¯ï¼š&quot;</span> + res.text)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">face = [<span class="string">&quot; &quot;</span>,<span class="string">&quot; &quot;</span>,<span class="string">&quot; &quot;</span>,<span class="string">&quot; &quot;</span>,<span class="string">&quot; &quot;</span>,<span class="string">&quot; &quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    nid = <span class="string">&quot;N0013000110151019&quot;</span></span><br><span class="line">    subOrg = <span class="string">&quot;&quot;</span></span><br><span class="line">    cardNo = <span class="built_in">str</span>(face[i])</span><br><span class="line">    openId = <span class="string">&quot;&quot;</span></span><br><span class="line">    checkConfig()</span><br><span class="line">    getStudy(getCourse(), nid, subOrg, cardNo)   </span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>python å®ç°çš„å®Œæˆé’å¹´å¤§å­¦ä¹ çš„è„šæœ¬å–½</p>]]></content>
      
      
      
        <tags>
            
            <tag> é’å¹´å¤§å­¦ä¹ æ‰“å¡py </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NCUæ ¡å›­ç½‘è‡ªåŠ¨ç™»å½•</title>
      <link href="/2023/04/13/ncuxyw/"/>
      <url>/2023/04/13/ncuxyw/</url>
      
        <content type="html"><![CDATA[<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> username,password,IE</span><br><span class="line">username = <span class="string">&quot;&quot;</span> <span class="keyword">REM</span>æ­¤å¤„å¼•å·å¡«å…¥å­¦å·</span><br><span class="line">password = <span class="string">&quot;&quot;</span>  <span class="keyword">REM</span>æ­¤å¤„å¼•å·å¡«å…¥å¯†ç </span><br><span class="line"><span class="keyword">Set</span> IE =<span class="built_in">CreateObject</span>(<span class="string">&quot;InternetExplorer.Application&quot;</span>)</span><br><span class="line">ie.FullScreen=<span class="number">0</span></span><br><span class="line">IE.Visible = <span class="literal">True</span></span><br><span class="line">IE.Navigate <span class="string">&quot;http://222.204.3.154/srun_portal_pc?ac_id=5&amp;srun_wait=1&amp;theme=basic1&quot;</span>  </span><br><span class="line"><span class="keyword">Do</span> <span class="keyword">while</span> IE.ReadyState&lt;&gt; <span class="number">4</span> <span class="keyword">or</span> IE.busy</span><br><span class="line">wscript.sleep <span class="number">2000</span> </span><br><span class="line"><span class="keyword">loop</span></span><br><span class="line">IE.document.querySelector(<span class="string">&quot;#username&quot;</span>).value=username  </span><br><span class="line">IE.document.querySelector(<span class="string">&quot;#password&quot;</span>).value=password</span><br><span class="line">ie.document.getElementsByName(<span class="string">&quot;domain&quot;</span>)(<span class="number">0</span>).children(<span class="number">1</span>).selected=trueREM     children <span class="keyword">REM</span>æ‹¬å·é‡Œçš„æ•°å­—ç§»åŠ¨<span class="number">1</span>ç”µä¿¡<span class="number">3</span>è”é€š<span class="number">4</span></span><br><span class="line"><span class="keyword">Set</span> btn =ie.Document.getElementById(<span class="string">&quot;login&quot;</span>)</span><br><span class="line">btn.click <span class="keyword">REM</span>å°†å°†æ–‡ä»¶åç¼€åæ”¹ä¸º.vbsç‚¹å‡»å³å¯è¿è¡Œ</span><br></pre></td></tr></table></figure><p>ç”¨ç®€å• vbs è„šæœ¬å®ç°å—æ˜Œå¤§å­¦æ ¡å›­ç½‘è‡ªåŠ¨ç™»å½•ï¼Œè®¾ç½®å¼€æœºè‡ªå¯åŠ¨åå°±è¡Œäº†ï¼Œæ”¾æ¡Œé¢ä¸Šç‚¹ä¸€ä¸‹ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> NCUæ ¡å›­ç½‘è‡ªåŠ¨ç™»å½• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜day2</title>
      <link href="/2023/04/13/day2/"/>
      <url>/2023/04/13/day2/</url>
      
        <content type="html"><![CDATA[<h4 id="day2"><a class="markdownIt-Anchor" href="#day2">#</a> day2</h4><h4 id="236-äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ"><a class="markdownIt-Anchor" href="#236-äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ">#</a> <a href="https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-tree/">236. äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</a></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    TreeNode* res;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">dfs</span><span class="params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!root) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">bool</span> l = <span class="built_in">dfs</span>(root-&gt;left, p, q);</span><br><span class="line">        <span class="type">bool</span> r = <span class="built_in">dfs</span>(root-&gt;right, p, q);</span><br><span class="line">        <span class="keyword">if</span> ((l &amp;&amp; r) || ((root-&gt;val == p-&gt;val || root-&gt;val == q-&gt;val) &amp;&amp; (l || r))) res = root;</span><br><span class="line">        <span class="keyword">return</span> l || r || (root-&gt;val == p-&gt;val || root-&gt;val == q-&gt;val);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">TreeNode* <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">dfs</span>(root, p, q);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>dfs å–½ï¼ŒæŠŠæ¡ä½ä»€ä¹ˆæ˜¯æœ€è¿‘å…¬å…±ç¥–å…ˆå°±è¡Œäº†ï¼</p><p>ä»Šå¤©æœ‰ç‚¹å¿æ„§ï¼Œæœ‰ç‚¹æ‘†äº†ã€‚</p><p>æ—©ä¸Šå¯å®¤æ–­ç”µï¼Œå¤§é›¨ä¹Ÿä¸å¥½å……ï¼Œæ™šä¸Šåˆçœ‹äº†å¥½ä¹…å°è¯´ï¼Œä»Šå¤©å°±è¿™æ ·å§ï¼Œåˆ·ä¸€é“é¢˜ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> lc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è°ƒè¯•ä¸­çš„å°bug</title>
      <link href="/2023/04/13/problem/"/>
      <url>/2023/04/13/problem/</url>
      
        <content type="html"><![CDATA[<h4 id="åœ¨è‡ªå®šä¹‰widgetçš„æ—¶å€™å‡ºç°å¦‚ä¸‹é”™è¯¯field-w-has-incomplete-type"><a class="markdownIt-Anchor" href="#åœ¨è‡ªå®šä¹‰widgetçš„æ—¶å€™å‡ºç°å¦‚ä¸‹é”™è¯¯field-w-has-incomplete-type">#</a> åœ¨è‡ªå®šä¹‰ Widget çš„æ—¶å€™å‡ºç°å¦‚ä¸‹é”™è¯¯ field w has incomplete type</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Widget</span> : <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Widget</span>(QWidget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">Widget</span>();</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Widget w;</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">wwrite</span><span class="params">(QString s, QWidget *widget)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">savestabuyEditinfo</span><span class="params">(QLineEdit *lineEditPass, QString tex)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯å› ä¸ºå¤´æ–‡ä»¶å¯¹ç±»æˆ–è€…ç»“æ„ä½“è¿›è¡Œäº†å‰å‘å£°æ˜ï¼Œåé¢ä½¿ç”¨äº†è¯¥ç±»å®šä¹‰äº†å¯¹è±¡ï¼Œå¯¼è‡´ç¼–è¯‘æŠ¥é”™ã€‚</p><p>åŸå› åœ¨äºå‰å‘å£°æ˜ç±»æˆ–è€…ç»“æ„ä½“ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨è¿˜ä¸çŸ¥é“å®šä¹‰ï¼Œæ— æ³•çŸ¥é“ç±»å†…éƒ¨æˆå‘˜ï¼Œæ‰€ä»¥æ— æ³•æ„é€ å®ä¾‹å¯¹è±¡ï¼Œå› æ­¤å‰å‘å£°æ˜çš„ç±»æˆ–è€…ç»“æ„ä½“åªèƒ½ç”¨æ¥å®šä¹‰æŒ‡é’ˆæˆ–è€…å¼•ç”¨ã€‚</p><h4 id="cannot-call-member-function-without-object-å¤„ç†"><a class="markdownIt-Anchor" href="#cannot-call-member-function-without-object-å¤„ç†">#</a> cannot call member function â€˜ â€˜ without object å¤„ç†</h4><p>åº”è¯¥å…ˆåˆå§‹åŒ–ä¸€ä¸ªç±»å“¦è¿™ä¸ª</p><p><strong>è«åå…¶å¦™çš„æ³¨é‡Šæ‰çš„å‡½æ•°ä¹Ÿä¼šå‡ºç°æç¤ºæˆ‘æœªåˆå§‹åŒ–ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦å°†æ•´ä¸ªé¡¹ç›®é‡æ„</strong></p><h4 id="no-such-slot-widgetsavestabuyeditinfolineedit-text-in"><a class="markdownIt-Anchor" href="#no-such-slot-widgetsavestabuyeditinfolineedit-text-in">#</a> No such slot Widget::savestabuyEditinfo(lineEdit, text) in</h4><p>å¥‡æ€ªï¼Œæ˜æ˜ä»¥åŠåœ¨ Widget é‡Œ public slots å£°æ˜äº†ï¼Œå´ä»ç„¶æœ‰é—®é¢˜</p><h4 id="qiodevicewrite-qfile-dqtprojectaguaguimage"><a class="markdownIt-Anchor" href="#qiodevicewrite-qfile-dqtprojectaguaguimage">#</a> QIODevice::write (QFile, &quot;D:qtprojectaguaguimage</h4><h4 id="es-device-not-open"><a class="markdownIt-Anchor" href="#es-device-not-open">#</a> es&quot;): device not open</h4><p>æœäº†ï¼Œqt è¯»å– txt å¹¶ä¸ç”¨å’Œ image ä¸€æ ·ï¼Œè¿˜å¾—åŠ åˆ°å·¥ç¨‹çœ‹é‡Œ</p><p>ä¿¡å·æ§½çš„é—®é¢˜ï¼Œä¸€ç›´æ£€æµ‹ä¸åˆ°</p><p>æ–‡ä»¶è¯»å†™çš„é—®é¢˜ï¼Œä¸€ç›´å†™ä¸ä¸Š</p><p>åäº†åäº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> bug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜day1</title>
      <link href="/2023/04/12/lc/"/>
      <url>/2023/04/12/lc/</url>
      
        <content type="html"><![CDATA[<h4 id="238-é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯"><a class="markdownIt-Anchor" href="#238-é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯">#</a> <a href="https://leetcode.cn/problems/product-of-array-except-self/">238. é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯</a></h4><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œè¿”å› æ•°ç»„ answer ï¼Œå…¶ä¸­ answer [i] ç­‰äº nums ä¸­é™¤ nums [i] ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯ ã€‚</p><p>é¢˜ç›®æ•°æ® ä¿è¯ æ•°ç»„ nums ä¹‹ä¸­ä»»æ„å…ƒç´ çš„å…¨éƒ¨å‰ç¼€å…ƒç´ å’Œåç¼€çš„ä¹˜ç§¯éƒ½åœ¨  32 ä½ æ•´æ•°èŒƒå›´å†…ã€‚</p><p>è¯·ä¸è¦ä½¿ç”¨é™¤æ³•ï¼Œä¸”åœ¨ O (n) æ—¶é—´å¤æ‚åº¦å†…å®Œæˆæ­¤é¢˜ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: nums = [1,2,3,4]</span><br><span class="line">è¾“å‡º: [24,12,8,6]</span><br></pre></td></tr></table></figure><p>éå†ä¸¤è¾¹</p><p>ç”¨ l è®°å½•è¯¥ç‚¹å·¦ä¾§æ‰€æœ‰æ•°çš„æˆç»©ï¼Œ</p><p>éšåå€’è¿‡æ¥å†ç®—å³è¾¹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">productExceptSelf</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">l</span><span class="params">(nums.size())</span></span>;</span><br><span class="line">        l[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; nums.<span class="built_in">size</span>(); i ++) &#123;</span><br><span class="line">            l[i] = l[i<span class="number">-1</span>] * nums[i<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> r = nums[nums.<span class="built_in">size</span>()<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = nums.<span class="built_in">size</span>()<span class="number">-2</span>; i &gt;= <span class="number">0</span>; i --) &#123;</span><br><span class="line">            l[i] = l[i] * r;</span><br><span class="line">            r *= nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="200-å²›å±¿æ•°é‡"><a class="markdownIt-Anchor" href="#200-å²›å±¿æ•°é‡">#</a> <a href="https://leetcode.cn/problems/task-scheduler/">[200. å²›å±¿æ•°é‡]</a></h4><p>ç»™ä½ ä¸€ä¸ªç”± â€˜1â€™ï¼ˆé™†åœ°ï¼‰å’Œ â€˜0â€™ï¼ˆæ°´ï¼‰ç»„æˆçš„çš„äºŒç»´ç½‘æ ¼ï¼Œè¯·ä½ è®¡ç®—ç½‘æ ¼ä¸­å²›å±¿çš„æ•°é‡ã€‚</p><p>å²›å±¿æ€»æ˜¯è¢«æ°´åŒ…å›´ï¼Œå¹¶ä¸”æ¯åº§å²›å±¿åªèƒ½ç”±æ°´å¹³æ–¹å‘å’Œ / æˆ–ç«–ç›´æ–¹å‘ä¸Šç›¸é‚»çš„é™†åœ°è¿æ¥å½¢æˆã€‚</p><p>æ­¤å¤–ï¼Œä½ å¯ä»¥å‡è®¾è¯¥ç½‘æ ¼çš„å››æ¡è¾¹å‡è¢«æ°´åŒ…å›´ã€‚ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šgrid = [</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;0&quot;,&quot;1&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;]</span><br><span class="line">]</span><br><span class="line">è¾“å‡ºï¼š1</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(vector&lt;vector&lt;<span class="type">char</span>&gt;&gt;&amp; grid, <span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//if(x == grid.size() &amp;&amp; y == grid[0].size()) return ;</span></span><br><span class="line">        grid[x][y] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(x<span class="number">-1</span> &gt;= <span class="number">0</span> &amp;&amp; grid[x<span class="number">-1</span>][y] == <span class="string">&#x27;1&#x27;</span>) <span class="built_in">dfs</span>(grid, x<span class="number">-1</span>, y);</span><br><span class="line">        <span class="keyword">if</span>(y<span class="number">-1</span> &gt;= <span class="number">0</span> &amp;&amp; grid[x][y<span class="number">-1</span>] == <span class="string">&#x27;1&#x27;</span>) <span class="built_in">dfs</span>(grid, x, y<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span>(x+<span class="number">1</span> &lt; grid.<span class="built_in">size</span>() &amp;&amp; grid[x+<span class="number">1</span>][y] == <span class="string">&#x27;1&#x27;</span>) <span class="built_in">dfs</span>(grid, x+<span class="number">1</span>, y);</span><br><span class="line">        <span class="keyword">if</span>(y+<span class="number">1</span> &lt; grid[<span class="number">0</span>].<span class="built_in">size</span>() &amp;&amp; grid[x][y+<span class="number">1</span>] == <span class="string">&#x27;1&#x27;</span>) <span class="built_in">dfs</span>(grid, x, y+<span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">numIslands</span><span class="params">(vector&lt;vector&lt;<span class="type">char</span>&gt;&gt;&amp; grid)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">         <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; grid.<span class="built_in">size</span>(); i ++) &#123;</span><br><span class="line">             <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; grid[<span class="number">0</span>].<span class="built_in">size</span>(); j ++) &#123;</span><br><span class="line">                 <span class="keyword">if</span> (grid[i][j] == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">                    res ++;</span><br><span class="line">                    <span class="built_in">dfs</span>(grid, i, j);</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> res;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯¹å²›å±¿é—®é¢˜ï¼Œæ·±æœå³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> lc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dayi</title>
      <link href="/2023/04/12/dayi/"/>
      <url>/2023/04/12/dayi/</url>
      
        <content type="html"><![CDATA[<h2 id="day1"><a class="markdownIt-Anchor" href="#day1">#</a> day1</h2><p>ä»Šå¤©å®ç°å¦‚ä¸‹åŠŸèƒ½ï¼š</p><ul><li><p>mainwindow æ·»åŠ èœå•æ </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QMenuBar *bar = <span class="built_in">menuBar</span>();<span class="comment">//åˆ›å»ºèœå•æ </span></span><br><span class="line"><span class="comment">//ä¸­é—´å„ç§æ“ä½œ</span></span><br><span class="line"><span class="built_in">setMenuBar</span>(bar);</span><br></pre></td></tr></table></figure></li><li><p>ç‚¹å‡»ç›¸åº”èœå•æ ä¸­çš„æ¯ä¸ªæŒ‰é’®å¯ä»¥è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªé¡µé¢</p><p>ä½¿ç”¨ connect</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ­¤å¤„éœ€è¦åœ¨ç±»ä¸­å¦‚ä¸‹</span></span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">openNewWindow</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">//å®ç°å¦‚ä¸‹</span></span><br><span class="line">QAction *action1 = <span class="keyword">new</span> <span class="built_in">QAction</span>(<span class="string">&quot;å…«è‚¡&quot;</span>, <span class="keyword">this</span>);</span><br><span class="line">bar-&gt;<span class="built_in">addAction</span>(action1);</span><br><span class="line"><span class="built_in">connect</span>(action1, <span class="built_in">SIGNAL</span>(<span class="built_in">triggered</span>()), <span class="keyword">this</span>,<span class="built_in">SLOT</span>(<span class="built_in">openNewWindow</span>()));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::openNewWindow</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QWidget *newWindow = <span class="keyword">new</span> QWidget;</span><br><span class="line">    newWindow-&gt;<span class="built_in">setWindowTitle</span>(<span class="string">&quot;New Window&quot;</span>);</span><br><span class="line">    <span class="function">QPixmap <span class="title">bkgnd</span><span class="params">(<span class="string">&quot;:/new/prefix1/10.png&quot;</span>)</span></span>;</span><br><span class="line">    bkgnd = bkgnd.<span class="built_in">scaled</span>(<span class="keyword">this</span>-&gt;<span class="built_in">size</span>(), Qt::IgnoreAspectRatio);</span><br><span class="line">    QPalette palette;</span><br><span class="line">    palette.<span class="built_in">setBrush</span>(QPalette::Background, bkgnd);</span><br><span class="line">    newWindow-&gt;<span class="built_in">setPalette</span>(palette);</span><br><span class="line">    newWindow-&gt;<span class="built_in">show</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>èƒŒæ™¯å›¾</p><p>æ­¤å¤„éœ€è¦é¦–å…ˆåœ¨å·¥ç¨‹ä¸­æ·»åŠ  resource æ–‡ä»¶ï¼Œå†å‘å…¶ä¸­æ·»åŠ å›¾ç‰‡ï¼Œå¦åˆ™å°±ç®—è·¯å¾„æ­£ç¡®ä¹Ÿä¼šè¯»å–ä¸å‡ºæ¥å›¾ç‰‡</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QPixmap <span class="title">bkgnd</span><span class="params">(<span class="string">&quot;:/new/prefix1/6.png&quot;</span>)</span></span>;</span><br><span class="line">bkgnd = bkgnd.<span class="built_in">scaled</span>(<span class="keyword">this</span>-&gt;<span class="built_in">size</span>(), Qt::IgnoreAspectRatio);</span><br><span class="line">QPalette palette;</span><br><span class="line">palette.<span class="built_in">setBrush</span>(QPalette::Background, bkgnd);</span><br><span class="line"><span class="keyword">this</span>-&gt;<span class="built_in">setPalette</span>(palette);</span><br></pre></td></tr></table></figure></li></ul><p>æ˜æ—¥è®¡åˆ’ï¼š</p><p>å®ç°æ‰“å¼€çš„é¡µé¢ä¸­èƒ½å¤Ÿè¯»å– txtï¼Œå†™å…¥ txt, ä»¥åŠç­”æ¡ˆåŒ¹é…ï¼Œå®ç°åŸºç¡€é—®ç­”å½¢å¼ã€‚</p><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç§‹æ‹›å­¦ä¹ å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/04/11/hello-world/"/>
      <url>/2023/04/11/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start">#</a> Quick Start</h2><h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post">#</a> Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server">#</a> Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files">#</a> Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites">#</a> Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
